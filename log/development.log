Started POST "/test" for ::1 at 2023-02-21 18:28:39 +0800
  [1m[35m (1.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  
Zeitwerk::NameError (expected file /Users/marc/www/sandbox/airking/app/controllers/test_controller.rb to define constant TestController, but didn't):
  
zeitwerk (2.6.7) lib/zeitwerk/loader/callbacks.rb:25:in `on_file_autoloaded'
zeitwerk (2.6.7) lib/zeitwerk/kernel.rb:31:in `require'
activesupport (6.0.6.1) lib/active_support/inflector/methods.rb:282:in `const_get'
activesupport (6.0.6.1) lib/active_support/inflector/methods.rb:282:in `block in constantize'
activesupport (6.0.6.1) lib/active_support/inflector/methods.rb:280:in `each'
activesupport (6.0.6.1) lib/active_support/inflector/methods.rb:280:in `inject'
activesupport (6.0.6.1) lib/active_support/inflector/methods.rb:280:in `constantize'
activesupport (6.0.6.1) lib/active_support/dependencies/zeitwerk_integration.rb:19:in `constantize'
actionpack (6.0.6.1) lib/action_dispatch/http/request.rb:89:in `controller_class_for'
actionpack (6.0.6.1) lib/action_dispatch/http/parameters.rb:100:in `binary_params_for?'
actionpack (6.0.6.1) lib/action_dispatch/http/parameters.rb:91:in `set_binary_encoding'
actionpack (6.0.6.1) lib/action_dispatch/http/parameters.rb:69:in `path_parameters='
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:47:in `block in serve'
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.6.1) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack (2.2.6.2) lib/rack/etag.rb:27:in `call'
rack (2.2.6.2) lib/rack/conditional_get.rb:40:in `call'
rack (2.2.6.2) lib/rack/head.rb:12:in `call'
activerecord (6.0.6.1) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.6.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.6.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.6.1) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.6.2) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.6.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.6.2) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.6.1) lib/rails/engine.rb:527:in `call'
puma (4.3.12) lib/puma/configuration.rb:228:in `call'
puma (4.3.12) lib/puma/server.rb:727:in `handle_request'
puma (4.3.12) lib/puma/server.rb:476:in `process_client'
puma (4.3.12) lib/puma/server.rb:332:in `block in run'
puma (4.3.12) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started POST "/test" for ::1 at 2023-02-21 18:28:58 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 2ms (ActiveRecord: 0.0ms | Allocations: 782)


Started GET "/test" for 127.0.0.1 at 2023-02-22 09:08:48 +0800
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  
ActionController::RoutingError (No route matches [GET] "/test"):
  
actionpack (6.0.6.1) lib/action_dispatch/middleware/debug_exceptions.rb:36:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.6.1) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.6.2) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.6.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.6.2) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.6.1) lib/rails/engine.rb:527:in `call'
puma (4.3.12) lib/puma/configuration.rb:228:in `call'
puma (4.3.12) lib/puma/server.rb:727:in `handle_request'
puma (4.3.12) lib/puma/server.rb:476:in `process_client'
puma (4.3.12) lib/puma/server.rb:332:in `block in run'
puma (4.3.12) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/favicon.ico" for 127.0.0.1 at 2023-02-22 09:08:48 +0800
  
ActionController::RoutingError (No route matches [GET] "/favicon.ico"):
  
actionpack (6.0.6.1) lib/action_dispatch/middleware/debug_exceptions.rb:36:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.6.1) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.6.2) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.6.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.6.2) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.6.1) lib/rails/engine.rb:527:in `call'
puma (4.3.12) lib/puma/configuration.rb:228:in `call'
puma (4.3.12) lib/puma/server.rb:727:in `handle_request'
puma (4.3.12) lib/puma/server.rb:476:in `process_client'
puma (4.3.12) lib/puma/server.rb:332:in `block in run'
puma (4.3.12) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started POST "/test" for ::1 at 2023-02-22 09:09:03 +0800
Processing by TestController#create as */*
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms | Allocations: 379)


  
Hashie::Extensions::DeepFetch::UndefinedPathError (Could not fetch path (guest_details > localized_description) at guest_details):
  
app/controllers/test_controller.rb:35:in `create'
Started POST "/test" for ::1 at 2023-02-22 09:09:39 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 0ms (ActiveRecord: 0.0ms | Allocations: 72)


Started POST "/test" for ::1 at 2023-02-22 09:10:22 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 500 Internal Server Error in 0ms (ActiveRecord: 0.0ms | Allocations: 132)


  
Hashie::Extensions::DeepFetch::UndefinedPathError (Could not fetch path (reservation.guest_details.localized_description) at reservation.guest_details.localized_description):
  
app/controllers/test_controller.rb:35:in `create'
Started POST "/test" for ::1 at 2023-02-22 09:40:14 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 0ms (ActiveRecord: 0.0ms | Allocations: 70)


Started POST "/test" for ::1 at 2023-02-22 10:09:34 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  
NameError (uninitialized constant TestController::CoreExtensions):
  
app/controllers/test_controller.rb:4:in `<class:TestController>'
app/controllers/test_controller.rb:3:in `<main>'
Started POST "/test" for ::1 at 2023-02-22 10:09:48 +0800
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
  
NameError (uninitialized constant TestController::CoreExtensions):
  
app/controllers/test_controller.rb:4:in `<class:TestController>'
app/controllers/test_controller.rb:3:in `<main>'
Started POST "/test" for ::1 at 2023-02-22 10:11:22 +0800
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 1ms (ActiveRecord: 0.0ms | Allocations: 249)


Started POST "/test" for ::1 at 2023-02-22 10:11:48 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms | Allocations: 1308)


  
NoMethodError (undefined method `deep_fetch' for #<Hash:0x0000000112a9c140>
Did you mean?  deep_merge):
  
lib/core_extensions/hash/deep_fetch.rb:13:in `fetch_nested'
app/controllers/test_controller.rb:42:in `create'
Started POST "/test" for ::1 at 2023-02-22 10:12:43 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 0ms (ActiveRecord: 0.0ms | Allocations: 73)


Started POST "/test" for ::1 at 2023-02-22 14:58:41 +0800
  [1m[35m (1.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 59ms (ActiveRecord: 0.0ms | Allocations: 43334)


Started POST "/test" for ::1 at 2023-02-22 14:58:52 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 8ms (ActiveRecord: 0.0ms | Allocations: 6421)


Started POST "/test" for ::1 at 2023-02-22 14:59:13 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 6ms (ActiveRecord: 0.0ms | Allocations: 10829)


Started POST "/test" for ::1 at 2023-02-22 14:59:31 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 3ms (ActiveRecord: 0.0ms | Allocations: 7809)


Started POST "/test" for ::1 at 2023-02-22 15:08:03 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
Completed 204 No Content in 4ms (ActiveRecord: 0.0ms | Allocations: 7602)


Started POST "/test" for ::1 at 2023-02-22 15:15:07 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 204 No Content in 15ms (ActiveRecord: 0.0ms | Allocations: 7581)


Started POST "/test" for ::1 at 2023-02-22 15:15:20 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 204 No Content in 6ms (ActiveRecord: 0.0ms | Allocations: 7762)


Started POST "/test" for ::1 at 2023-02-22 15:15:35 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 204 No Content in 2ms (ActiveRecord: 0.0ms | Allocations: 7740)


Started POST "/test" for ::1 at 2023-02-22 15:15:52 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 204 No Content in 2ms (ActiveRecord: 0.0ms | Allocations: 7702)


Started POST "/test" for ::1 at 2023-02-22 15:57:36 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1861)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 15:57:45 +0800
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1932)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:04:11 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms | Allocations: 1878)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:04:17 +0800
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1932)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:03 +0800
  [1m[35m (0.5ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1932)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:04 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.0ms | Allocations: 1878)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:05 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 1877)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:05 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 1877)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:39 +0800
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1932)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:40 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.0ms | Allocations: 1878)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:41 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 1877)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:42 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 13ms (ActiveRecord: 0.0ms | Allocations: 1877)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:42 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.0ms | Allocations: 1877)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:05:43 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 1875)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:07:17 +0800
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1932)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:07:47 +0800
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1932)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:41:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:09:37 +0800
  [1m[35m (0.4ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms | Allocations: 1752)


  
NameError (uninitialized constant ReservationsServices):
  
app/controllers/test_controller.rb:39:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:11:13 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 5ms (ActiveRecord: 0.0ms | Allocations: 1785)


  
NameError (uninitialized constant TestController::ReservationsServices):
  
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:12:47 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.0ms | Allocations: 1775)


  
NameError (uninitialized constant TestController::ReservationsServices
Did you mean?  ReservationServices):
  
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:12:55 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 40ms (ActiveRecord: 0.0ms | Allocations: 56353)


  
NameError (undefined local variable or method `logger' for ReservationServices::Create:Class):
  
app/services/application_service.rb:43:in `rescue in run'
app/services/application_service.rb:38:in `run'
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:13:31 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
fail err=ArgumentError msg=wrong number of arguments (given 0, expected 1)
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.0ms | Allocations: 28500)


  
ArgumentError (wrong number of arguments (given 0, expected 1)):
  
lib/payloads/abnb.rb:11:in `match?'
app/services/reservation_services/create.rb:15:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:14:01 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
fail err=NoMethodError msg=undefined method `flat_map' for #<ActionController::Parameters:0x000000014ca3b338>
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.0ms | Allocations: 30402)


  
NoMethodError (undefined method `flat_map' for #<ActionController::Parameters:0x000000014ca3b338>):
  
lib/payloads/abnb.rb:11:in `match?'
app/services/reservation_services/create.rb:15:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:14:35 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
fail err=NoMethodError msg=undefined method `flat_map' for #<ActionController::Parameters:0x000000011e0845c0>
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 29448)


  
NoMethodError (undefined method `flat_map' for #<ActionController::Parameters:0x000000011e0845c0>):
  
lib/payloads/abnb.rb:12:in `match?'
app/services/reservation_services/create.rb:15:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:14:47 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
fail err=NoMethodError msg=undefined method `flat_map' for #<ActionController::Parameters:0x000000010328d120>
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.0ms | Allocations: 29457)


  
NoMethodError (undefined method `flat_map' for #<ActionController::Parameters:0x000000010328d120>):
  
lib/payloads/abnb.rb:13:in `match?'
app/services/reservation_services/create.rb:15:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:15:45 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
fail err=NoMethodError msg=undefined method `verbose?' for #<ReservationServices::Create:0x000000011e00d448>
Completed 500 Internal Server Error in 12ms (ActiveRecord: 0.0ms | Allocations: 41106)


  
NoMethodError (undefined method `verbose?' for #<ReservationServices::Create:0x000000011e00d448>):
  
app/services/application_service.rb:41:in `block in run'
app/services/application_service.rb:40:in `tap'
app/services/application_service.rb:40:in `run'
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:16:33 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 13ms (ActiveRecord: 0.0ms | Allocations: 37565)


Started POST "/test" for ::1 at 2023-02-22 16:17:39 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 11ms (ActiveRecord: 0.0ms | Allocations: 37461)


Started POST "/test" for ::1 at 2023-02-22 16:18:42 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 7ms (ActiveRecord: 0.0ms | Allocations: 36923)


Started POST "/test" for ::1 at 2023-02-22 16:18:47 +0800
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 24ms (ActiveRecord: 0.0ms | Allocations: 36927)


Started POST "/test" for ::1 at 2023-02-22 16:19:34 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 11ms (ActiveRecord: 0.0ms | Allocations: 45821)


Started POST "/test" for ::1 at 2023-02-22 16:21:22 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
fail err=NameError msg=undefined local variable or method `skema' for #<Payloads::Abnb:0x000000014c23f288>
Did you mean?  schema
               @schema
Completed 500 Internal Server Error in 12ms (ActiveRecord: 0.0ms | Allocations: 39751)


  
NameError (undefined local variable or method `skema' for #<Payloads::Abnb:0x000000014c23f288>
Did you mean?  schema
               @schema):
  
lib/payloads/abnb.rb:16:in `match?'
app/services/reservation_services/create.rb:16:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/test_controller.rb:5:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:21:43 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 9ms (ActiveRecord: 0.0ms | Allocations: 37344)


Started POST "/test" for ::1 at 2023-02-22 16:21:53 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 14ms (ActiveRecord: 0.0ms | Allocations: 40951)


Started POST "/test" for ::1 at 2023-02-22 16:22:29 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 10ms (ActiveRecord: 0.0ms | Allocations: 41048)


Started POST "/test" for ::1 at 2023-02-22 16:22:40 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 14ms (ActiveRecord: 0.0ms | Allocations: 41054)


Started POST "/test" for ::1 at 2023-02-22 16:24:13 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 43ms (ActiveRecord: 0.0ms | Allocations: 41797)


Started POST "/test" for ::1 at 2023-02-22 16:29:54 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 36ms (ActiveRecord: 0.0ms | Allocations: 41936)


Started POST "/test" for ::1 at 2023-02-22 16:30:11 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 47ms (ActiveRecord: 0.0ms | Allocations: 62201)


  
NameError (undefined local variable or method `path_params' for #<TestController:0x0000000103247148>
Did you mean?  Pathname):
  
app/controllers/test_controller.rb:11:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:30:24 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 34ms (ActiveRecord: 0.0ms | Allocations: 41944)


Started POST "/test" for ::1 at 2023-02-22 16:30:47 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 14ms (ActiveRecord: 0.0ms | Allocations: 42178)


Started POST "/test" for ::1 at 2023-02-22 16:31:26 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
Completed 500 Internal Server Error in 2ms (ActiveRecord: 0.0ms | Allocations: 622)


  
ActionController::UnfilteredParameters (unable to convert unpermitted parameters to hash):
  
app/controllers/test_controller.rb:8:in `create'
Started POST "/test" for ::1 at 2023-02-22 16:31:39 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 12ms (ActiveRecord: 0.0ms | Allocations: 39826)


Started POST "/test" for ::1 at 2023-02-22 16:33:32 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 12ms (ActiveRecord: 0.0ms | Allocations: 40000)


Started POST "/test" for ::1 at 2023-02-22 16:34:21 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 11ms (ActiveRecord: 0.0ms | Allocations: 39950)


Started POST "/test" for ::1 at 2023-02-22 16:36:09 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 16ms (ActiveRecord: 0.0ms | Allocations: 39921)


Started POST "/test" for ::1 at 2023-02-22 16:36:55 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 12ms (ActiveRecord: 0.0ms | Allocations: 39935)


Started POST "/test" for ::1 at 2023-02-22 16:44:39 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by TestController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}, "test"=>{"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 33ms (ActiveRecord: 0.0ms | Allocations: 39839)


Started POST "/reservations" for ::1 at 2023-02-22 16:46:34 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=nil
Completed 204 No Content in 8ms (ActiveRecord: 0.0ms | Allocations: 29410)


Started POST "/reservations" for ::1 at 2023-02-22 16:53:21 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=nil
Completed 204 No Content in 11ms (ActiveRecord: 0.0ms | Allocations: 29093)


Started POST "/reservations" for ::1 at 2023-02-22 16:57:32 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NameError msg=undefined local variable or method `params' for #<Payloads::Abnb:0x000000011cfeaa48>
Did you mean?  @params
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.0ms | Allocations: 30874)


  
NameError (undefined local variable or method `params' for #<Payloads::Abnb:0x000000011cfeaa48>
Did you mean?  @params):
  
lib/payloads/abnb.rb:18:in `validate'
app/services/reservation_services/create.rb:13:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:7:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 16:57:40 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `match?' for #<Dry::Schema::Result:0x000000011d8360d0>
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.0ms | Allocations: 29834)


  
NoMethodError (undefined method `match?' for #<Dry::Schema::Result:0x000000011d8360d0>):
  
app/services/reservation_services/create.rb:16:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:7:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 16:58:11 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `match?' for #<Dry::Schema::Result:0x00000001030be5b0>
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.0ms | Allocations: 29834)


  
NoMethodError (undefined method `match?' for #<Dry::Schema::Result:0x00000001030be5b0>):
  
app/services/reservation_services/create.rb:16:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:7:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 16:58:41 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=super: no superclass method `validate' for #<Payloads::Abnb:0x000000011cbec1d0>
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 30954)


  
NoMethodError (super: no superclass method `validate' for #<Payloads::Abnb:0x000000011cbec1d0>):
  
lib/payloads/abnb.rb:20:in `validate'
app/services/reservation_services/create.rb:13:in `block in perform'
app/services/reservation_services/create.rb:12:in `each'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:7:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 16:59:10 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=nil
Completed 204 No Content in 10ms (ActiveRecord: 0.0ms | Allocations: 29218)


Started POST "/reservations" for ::1 at 2023-02-22 16:59:34 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=nil
Completed 204 No Content in 9ms (ActiveRecord: 0.0ms | Allocations: 29102)


Started POST "/reservations" for ::1 at 2023-02-22 17:03:29 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Payloads::Abnb:0x000000011cca4438 @schema=#<Dry::Schema::Params keys=[{"reservation"=>["code", "start_date", "end_date", "expected_payout_amount", {"guest_details"=>["localized_description", "number_of_adults", "number_of_children", "number_of_infants"]}, "guest_email", "guest_first_name", "guest_last_name", "guest_phone_numbers", "listing_security_price_accurate", "host_currency", "nights", "number_of_guests", "status_type", "total_paid_amount_accurate"]}] rules={:reservation=>"key?(:reservation) AND key[reservation](hash? AND set(key?(:code) AND key[code](filled? AND str?), key?(:start_date) AND key[start_date](filled? AND str?), key?(:end_date) AND key[end_date](filled? AND str?), key?(:expected_payout_amount) AND key[expected_payout_amount](filled? AND str?), key?(:guest_details) AND key[guest_details](hash? AND set(key?(:localized_description) AND key[localized_description](filled? AND str?), key?(:number_of_adults) AND key[number_of_adults](filled? AND int?), key?(:number_of_children) AND key[number_of_children](filled? AND int?), key?(:number_of_infants) AND key[number_of_infants](filled? AND int?))), key?(:guest_email) AND key[guest_email](filled? AND str?), key?(:guest_first_name) AND key[guest_first_name](filled? AND str?), key?(:guest_last_name) AND key[guest_last_name](filled? AND str?), key?(:guest_phone_numbers) AND key[guest_phone_numbers](array? AND each(str?)), key?(:listing_security_price_accurate) AND key[listing_security_price_accurate](filled? AND str?), key?(:host_currency) AND key[host_currency](filled? AND str?), key?(:nights) AND key[nights](filled? AND int?), key?(:number_of_guests) AND key[number_of_guests](filled? AND int?), key?(:status_type) AND key[status_type](filled? AND str?), key?(:total_paid_amount_accurate) AND key[total_paid_amount_accurate](filled? AND str?)))"}>, @skema=#<Dry::Schema::Result{:reservation=>{:code=>"XXX12345678", :start_date=>"2021-03-12", :end_date=>"2021-03-16", :expected_payout_amount=>"3800.00", :guest_details=>{:localized_description=>"4 guests", :number_of_adults=>2, :number_of_children=>2, :number_of_infants=>0}, :guest_email=>"wayne_woodbridge@bnb.com", :guest_first_name=>"Wayne", :guest_last_name=>"Woodbridge", :guest_phone_numbers=>["639123456789", "639123456789"], :listing_security_price_accurate=>"500.00", :host_currency=>"AUD", :nights=>4, :number_of_guests=>4, :status_type=>"accepted", :total_paid_amount_accurate=>"4300.00"}} errors={} path=[]>>
Completed 204 No Content in 11ms (ActiveRecord: 0.0ms | Allocations: 29512)


Started POST "/reservations" for ::1 at 2023-02-22 17:03:50 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Payloads::Abnb:0x00000001030ad300 @schema=#<Dry::Schema::Params keys=[{"reservation"=>["code", "start_date", "end_date", "expected_payout_amount", {"guest_details"=>["localized_description", "number_of_adults", "number_of_children", "number_of_infants"]}, "guest_email", "guest_first_name", "guest_last_name", "guest_phone_numbers", "listing_security_price_accurate", "host_currency", "nights", "number_of_guests", "status_type", "total_paid_amount_accurate"]}] rules={:reservation=>"key?(:reservation) AND key[reservation](hash? AND set(key?(:code) AND key[code](filled? AND str?), key?(:start_date) AND key[start_date](filled? AND str?), key?(:end_date) AND key[end_date](filled? AND str?), key?(:expected_payout_amount) AND key[expected_payout_amount](filled? AND str?), key?(:guest_details) AND key[guest_details](hash? AND set(key?(:localized_description) AND key[localized_description](filled? AND str?), key?(:number_of_adults) AND key[number_of_adults](filled? AND int?), key?(:number_of_children) AND key[number_of_children](filled? AND int?), key?(:number_of_infants) AND key[number_of_infants](filled? AND int?))), key?(:guest_email) AND key[guest_email](filled? AND str?), key?(:guest_first_name) AND key[guest_first_name](filled? AND str?), key?(:guest_last_name) AND key[guest_last_name](filled? AND str?), key?(:guest_phone_numbers) AND key[guest_phone_numbers](array? AND each(str?)), key?(:listing_security_price_accurate) AND key[listing_security_price_accurate](filled? AND str?), key?(:host_currency) AND key[host_currency](filled? AND str?), key?(:nights) AND key[nights](filled? AND int?), key?(:number_of_guests) AND key[number_of_guests](filled? AND int?), key?(:status_type) AND key[status_type](filled? AND str?), key?(:total_paid_amount_accurate) AND key[total_paid_amount_accurate](filled? AND str?)))"}>, @skema=#<Dry::Schema::Result{:reservation=>{:code=>"XXX12345678", :start_date=>"2021-03-12", :end_date=>"2021-03-16", :expected_payout_amount=>"3800.00", :guest_details=>{:localized_description=>"4 guests", :number_of_adults=>2, :number_of_children=>2, :number_of_infants=>0}, :guest_email=>"wayne_woodbridge@bnb.com", :guest_first_name=>"Wayne", :guest_last_name=>"Woodbridge", :guest_phone_numbers=>["639123456789", "639123456789"], :listing_security_price_accurate=>"500.00", :host_currency=>"AUD", :nights=>4, :number_of_guests=>4, :status_type=>"accepted", :total_paid_amount_accurate=>"4300.00"}} errors={} path=[]>>
Completed 204 No Content in 9ms (ActiveRecord: 0.0ms | Allocations: 29623)


Started POST "/reservations" for ::1 at 2023-02-22 17:07:41 +0800
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 34ms (ActiveRecord: 0.0ms | Allocations: 28889)


Started POST "/reservations" for ::1 at 2023-02-22 17:08:01 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=[Payloads::Abnb]
Completed 204 No Content in 8ms (ActiveRecord: 0.0ms | Allocations: 29512)


Started POST "/reservations" for ::1 at 2023-02-22 18:07:13 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x00000001030a79f0 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 19ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 30583)


Started POST "/reservations" for ::1 at 2023-02-22 18:07:52 +0800
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x000000014c8ae358 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 20ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 29168)


Started POST "/reservations" for ::1 at 2023-02-22 18:07:55 +0800
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Payloads::Abnb:0x000000011cdbc550 @schema=#<Dry::Schema::Params keys=[{"reservation"=>["code", "start_date", "end_date", "expected_payout_amount", {"guest_details"=>["localized_description", "number_of_adults", "number_of_children", "number_of_infants"]}, "guest_email", "guest_first_name", "guest_last_name", "guest_phone_numbers", "listing_security_price_accurate", "host_currency", "nights", "number_of_guests", "status_type", "total_paid_amount_accurate"]}] rules={:reservation=>"key?(:reservation) AND key[reservation](hash? AND set(key?(:code) AND key[code](filled? AND str?), key?(:start_date) AND key[start_date](filled? AND str?), key?(:end_date) AND key[end_date](filled? AND str?), key?(:expected_payout_amount) AND key[expected_payout_amount](filled? AND str?), key?(:guest_details) AND key[guest_details](hash? AND set(key?(:localized_description) AND key[localized_description](filled? AND str?), key?(:number_of_adults) AND key[number_of_adults](filled? AND int?), key?(:number_of_children) AND key[number_of_children](filled? AND int?), key?(:number_of_infants) AND key[number_of_infants](filled? AND int?))), key?(:guest_email) AND key[guest_email](filled? AND str?), key?(:guest_first_name) AND key[guest_first_name](filled? AND str?), key?(:guest_last_name) AND key[guest_last_name](filled? AND str?), key?(:guest_phone_numbers) AND key[guest_phone_numbers](array? AND each(str?)), key?(:listing_security_price_accurate) AND key[listing_security_price_accurate](filled? AND str?), key?(:host_currency) AND key[host_currency](filled? AND str?), key?(:nights) AND key[nights](filled? AND int?), key?(:number_of_guests) AND key[number_of_guests](filled? AND int?), key?(:status_type) AND key[status_type](filled? AND str?), key?(:total_paid_amount_accurate) AND key[total_paid_amount_accurate](filled? AND str?)))"}>, @skema=#<Dry::Schema::Result{:reservation=>{:code=>"XXX12345678", :start_date=>"2021-03-12", :end_date=>"2021-03-16", :expected_payout_amount=>"3800.00", :guest_details=>{:localized_description=>"4 guests", :number_of_adults=>2, :number_of_children=>2, :number_of_infants=>0}, :guest_email=>"wayne_woodbridge@bnb.com", :guest_first_name=>"Wayne", :guest_last_name=>"Woodbridge", :guest_phone_numbers=>["639123456789", "639123456789"], :listing_security_price_accurate=>"500.00", :host_currency=>"AUD", :nights=>4, :number_of_guests=>4, :status_type=>"accepted", :total_paid_amount_accurate=>"4300.00"}} errors={} path=[]>>
Completed 500 Internal Server Error in 34ms (ActiveRecord: 0.0ms | Allocations: 29603)


  
NoMethodError (undefined method `new' for nil:NilClass):
  
lib/utils/response.rb:20:in `to_h'
app/controllers/reservations_controller.rb:14:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:16:23 +0800
  [1m[35m (0.3ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Payloads::Abnb:0x0000000107ca6680 @schema=#<Dry::Schema::Params keys=[{"reservation"=>["code", "start_date", "end_date", "expected_payout_amount", {"guest_details"=>["localized_description", "number_of_adults", "number_of_children", "number_of_infants"]}, "guest_email", "guest_first_name", "guest_last_name", "guest_phone_numbers", "listing_security_price_accurate", "host_currency", "nights", "number_of_guests", "status_type", "total_paid_amount_accurate"]}] rules={:reservation=>"key?(:reservation) AND key[reservation](hash? AND set(key?(:code) AND key[code](filled? AND str?), key?(:start_date) AND key[start_date](filled? AND str?), key?(:end_date) AND key[end_date](filled? AND str?), key?(:expected_payout_amount) AND key[expected_payout_amount](filled? AND str?), key?(:guest_details) AND key[guest_details](hash? AND set(key?(:localized_description) AND key[localized_description](filled? AND str?), key?(:number_of_adults) AND key[number_of_adults](filled? AND int?), key?(:number_of_children) AND key[number_of_children](filled? AND int?), key?(:number_of_infants) AND key[number_of_infants](filled? AND int?))), key?(:guest_email) AND key[guest_email](filled? AND str?), key?(:guest_first_name) AND key[guest_first_name](filled? AND str?), key?(:guest_last_name) AND key[guest_last_name](filled? AND str?), key?(:guest_phone_numbers) AND key[guest_phone_numbers](array? AND each(str?)), key?(:listing_security_price_accurate) AND key[listing_security_price_accurate](filled? AND str?), key?(:host_currency) AND key[host_currency](filled? AND str?), key?(:nights) AND key[nights](filled? AND int?), key?(:number_of_guests) AND key[number_of_guests](filled? AND int?), key?(:status_type) AND key[status_type](filled? AND str?), key?(:total_paid_amount_accurate) AND key[total_paid_amount_accurate](filled? AND str?)))"}>, @skema=#<Dry::Schema::Result{:reservation=>{:code=>"XXX12345678", :start_date=>"2021-03-12", :end_date=>"2021-03-16", :expected_payout_amount=>"3800.00", :guest_details=>{:localized_description=>"4 guests", :number_of_adults=>2, :number_of_children=>2, :number_of_infants=>0}, :guest_email=>"wayne_woodbridge@bnb.com", :guest_first_name=>"Wayne", :guest_last_name=>"Woodbridge", :guest_phone_numbers=>["639123456789", "639123456789"], :listing_security_price_accurate=>"500.00", :host_currency=>"AUD", :nights=>4, :number_of_guests=>4, :status_type=>"accepted", :total_paid_amount_accurate=>"4300.00"}} errors={} path=[]>>
Completed 500 Internal Server Error in 33ms (ActiveRecord: 0.0ms | Allocations: 57405)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:15:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:18:13 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NameError msg=undefined local variable or method `params' for #<Payloads::Abnb:0x00000001079f3f78>
Completed 500 Internal Server Error in 18ms (ActiveRecord: 0.0ms | Allocations: 31508)


  
NameError (undefined local variable or method `params' for #<Payloads::Abnb:0x00000001079f3f78>):
  
lib/payloads/abnb.rb:20:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:18:20 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `[]' for nil:NilClass
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.0ms | Allocations: 29729)


  
NoMethodError (undefined method `[]' for nil:NilClass):
  
lib/payloads/abnb.rb:20:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:18:34 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:id=>nil}
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.0ms | Allocations: 29787)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:15:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:18:49 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:id=>nil}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 29677)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:19:33 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `deep_fetch' for #<ActiveSupport::HashWithIndifferentAccess:0x00000001079c2540>
Did you mean?  deep_merge
Completed 500 Internal Server Error in 14ms (ActiveRecord: 0.0ms | Allocations: 30453)


  
NoMethodError (undefined method `deep_fetch' for #<ActiveSupport::HashWithIndifferentAccess:0x00000001079c2540>
Did you mean?  deep_merge):
  
lib/payloads/abnb.rb:21:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:20:16 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `deep_fetch' for #<ActiveSupport::HashWithIndifferentAccess:0x0000000107cce810>
Did you mean?  deep_merge
Completed 500 Internal Server Error in 17ms (ActiveRecord: 0.0ms | Allocations: 30613)


  
NoMethodError (undefined method `deep_fetch' for #<ActiveSupport::HashWithIndifferentAccess:0x0000000107cce810>
Did you mean?  deep_merge):
  
lib/payloads/abnb.rb:23:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:20:18 +0800
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `deep_fetch' for #<ActiveSupport::HashWithIndifferentAccess:0x0000000107c0c3a0>
Did you mean?  deep_merge
Completed 500 Internal Server Error in 18ms (ActiveRecord: 0.0ms | Allocations: 29910)


  
NoMethodError (undefined method `deep_fetch' for #<ActiveSupport::HashWithIndifferentAccess:0x0000000107c0c3a0>
Did you mean?  deep_merge):
  
lib/payloads/abnb.rb:23:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:20:34 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=ArgumentError msg=wrong number of arguments (given 2, expected 1)
Completed 500 Internal Server Error in 14ms (ActiveRecord: 0.0ms | Allocations: 29406)


  
ArgumentError (wrong number of arguments (given 2, expected 1)):
  
lib/core_extensions/hash/deep_fetch.rb:6:in `fetch_nested'
lib/payloads/abnb.rb:23:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:20:49 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:id=>"XXX12345678"}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 30065)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:22:40 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<OpenStruct id="XXX12345678">
Completed 200 OK in 17ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 30091)


Started POST "/reservations" for ::1 at 2023-02-22 18:23:06 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<OpenStruct id="XXX12345678", code="XXX12345678">
Completed 200 OK in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 30103)


Started POST "/reservations" for ::1 at 2023-02-22 18:35:11 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<OpenStruct id="XXX12345678", code="XXX12345678">
Completed 200 OK in 19ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 28851)


Started POST "/reservations" for ::1 at 2023-02-22 18:40:08 +0800
  [1m[35m (0.1ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:id=>"XXX12345678", :code=>"XXX12345678"}
Completed 500 Internal Server Error in 14ms (ActiveRecord: 0.0ms | Allocations: 29993)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for ::1 at 2023-02-22 18:40:13 +0800
  [1m[35m (0.0ms)[0m  [1m[34mSELECT sqlite_version(*)[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<OpenStruct id="XXX12345678", code="XXX12345678">
Completed 200 OK in 11ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 30100)


  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "airking" ENCODING = 'utf8'[0m
  [1m[35m (54.4ms)[0m  [1m[35mCREATE DATABASE "gateway_test" ENCODING = 'utf8'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "airking" ENCODING = 'utf8'[0m
  [1m[35m (50.8ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35m (6.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 01:28:23.274436', '2023-02-23 01:28:23.274436') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateGuests (20230223014841)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.6ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20230223014841') RETURNING "version"[0m
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateReservations (20230223015218)
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.2ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" character varying NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.8ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateReservations (20230223015218)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20230223015218') RETURNING "version"[0m
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (5132.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking"[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (19.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking"[0m
  [1m[35m (16.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_db_test"[0m
  [1m[35m (72.9ms)[0m  [1m[35mCREATE DATABASE "airking" ENCODING = 'utf8'[0m
  [1m[35m (52.5ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (8.9ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (2.9ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.4ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 02:07:39.312611', '2023-02-23 02:07:39.312611') RETURNING "key"[0m
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '9036189701c7197313b8a9006cf29510c590dab0', '2023-02-23 02:07:39.326326', '2023-02-23 02:07:39.326326') RETURNING "key"[0m
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (5.4ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (3.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 02:07:39.382385', '2023-02-23 02:07:39.382385') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-02-23 02:07:39.389255' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '9036189701c7197313b8a9006cf29510c590dab0', '2023-02-23 02:07:39.396201', '2023-02-23 02:07:39.396201') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:15:52 +0000
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `save' for #<Payloads::Abnb:0x0000ffff74b6ca28>
Completed 500 Internal Server Error in 896ms (ActiveRecord: 0.0ms | Allocations: 69922)


  
NoMethodError (undefined method `save' for #<Payloads::Abnb:0x0000ffff74b6ca28>):
  
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:16:10 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/abnb.rb:22:in `save_guest'
  [1m[36mGuest Create (1.2ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 02:16:10.644357', '2023-02-23 02:16:10.644357') RETURNING "id"[0m
  ↳ lib/payloads/abnb.rb:22:in `save_guest'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/abnb.rb:22:in `save_guest'
complete out=#<OpenStruct id="XXX12345678", code="XXX12345678">
Completed 200 OK in 144ms (Views: 0.1ms | ActiveRecord: 5.8ms | Allocations: 37224)


Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:16:28 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/abnb.rb:22:in `save_guest'
  [1m[36mGuest Create (1.2ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 02:16:29.016944', '2023-02-23 02:16:29.016944') RETURNING "id"[0m
  ↳ lib/payloads/abnb.rb:22:in `save_guest'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/abnb.rb:22:in `save_guest'
fail err=ActiveRecord::RecordNotUnique msg=PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "index_guests_on_email"
DETAIL:  Key (email)=(wayne_woodbridge@bnb.com) already exists.

Completed 500 Internal Server Error in 28ms (ActiveRecord: 1.8ms | Allocations: 31118)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "index_guests_on_email"
DETAIL:  Key (email)=(wayne_woodbridge@bnb.com) already exists.
):
  
lib/payloads/abnb.rb:22:in `save_guest'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:27:09 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=private method `save_guest' called for #<Payloads::Abnb:0x0000aaaac822e430>
Completed 500 Internal Server Error in 63ms (ActiveRecord: 0.0ms | Allocations: 30866)


  
NoMethodError (private method `save_guest' called for #<Payloads::Abnb:0x0000aaaac822e430>):
  
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:27:17 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = NULL LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:28:in `guest'
fail err=ActiveRecord::RecordNotFound msg=Couldn't find Guest with 'id'={:email=>"wayne_woodbridge@bnb.com"}
Completed 404 Not Found in 56ms (ActiveRecord: 4.7ms | Allocations: 31186)


  
ActiveRecord::RecordNotFound (Couldn't find Guest with 'id'={:email=>"wayne_woodbridge@bnb.com"}):
  
lib/payloads/abnb.rb:28:in `guest'
lib/payloads/abnb.rb:22:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:28:43 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.8ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:28:in `guest'
complete out=#<Guest id: 1, email: "wayne_woodbridge@bnb.com", first_name: "Wayne", last_name: "Woodbridge", phone_numbers: "[\"639123456789\", \"639123456789\"]", created_at: "2023-02-23 02:16:10", updated_at: "2023-02-23 02:16:10">
Completed 500 Internal Server Error in 104ms (ActiveRecord: 5.3ms | Allocations: 36573)


  
NoMethodError (undefined method `code' for #<Guest:0x0000ffff74f6c5b0>):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:29:20 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:29:in `guest'
fail err=NoMethodError msg=undefined method `exists?' for #<Guest:0x0000ffff75106e20>
Completed 500 Internal Server Error in 51ms (ActiveRecord: 2.6ms | Allocations: 35906)


  
NoMethodError (undefined method `exists?' for #<Guest:0x0000ffff75106e20>):
  
lib/payloads/abnb.rb:23:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:29:53 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 11[0m
  ↳ lib/payloads/abnb.rb:22:in `p'
  [1m[36mGuest Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:23:in `save'
complete out=true
Completed 500 Internal Server Error in 73ms (ActiveRecord: 3.0ms | Allocations: 35155)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:32:18 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
complete out=nil
Completed 200 OK in 73ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 30000)


Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:33:48 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' ORDER BY "guests"."id" ASC LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:32:in `guest'
fail err=NoMethodError msg=undefined method `exists?' for #<Guest:0x0000ffff74f88260>
Completed 500 Internal Server Error in 67ms (ActiveRecord: 5.3ms | Allocations: 35995)


  
NoMethodError (undefined method `exists?' for #<Guest:0x0000ffff74f88260>):
  
lib/payloads/abnb.rb:23:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:34:06 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' ORDER BY "guests"."id" ASC LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:32:in `guest'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' ORDER BY "guests"."id" ASC LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:32:in `guest'
fail err=NoMethodError msg=undefined method `exists?' for nil:NilClass
Completed 500 Internal Server Error in 23ms (ActiveRecord: 0.5ms | Allocations: 30509)


  
NoMethodError (undefined method `exists?' for nil:NilClass):
  
lib/payloads/abnb.rb:23:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:34:40 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:29:in `guest'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m  [["email", "wayne1_woodbridge@bnb.com"], ["LIMIT", 1]]
  ↳ lib/payloads/abnb.rb:29:in `guest'
fail err=NoMethodError msg=undefined method `exists?' for nil:NilClass
Completed 500 Internal Server Error in 50ms (ActiveRecord: 1.5ms | Allocations: 31625)


  
NoMethodError (undefined method `exists?' for nil:NilClass):
  
lib/payloads/abnb.rb:23:in `save'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:36:08 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:30:in `guest'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/abnb.rb:34:in `save_guest'
  [1m[36mGuest Create (0.9ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne1_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 02:36:08.549502', '2023-02-23 02:36:08.549502') RETURNING "id"[0m
  ↳ lib/payloads/abnb.rb:34:in `save_guest'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/abnb.rb:34:in `save_guest'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/abnb.rb:43:in `save_reservation'
  [1m[36mReservation Create (1.4ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345678', 3, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 02:36:08.576995', '2023-02-23 02:36:08.576995') RETURNING "id"[0m
  ↳ lib/payloads/abnb.rb:43:in `save_reservation'
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/abnb.rb:43:in `save_reservation'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 02:36:08", updated_at: "2023-02-23 02:36:08">
Completed 200 OK in 135ms (Views: 0.4ms | ActiveRecord: 12.2ms | Allocations: 48984)


Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:42:24 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (1.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:30:in `guest'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/abnb.rb:43:in `save_reservation'
  [1m[36mReservation Create (1.6ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345678', 3, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 02:42:24.648556', '2023-02-23 02:42:24.648556') RETURNING "id"[0m
  ↳ lib/payloads/abnb.rb:43:in `save_reservation'
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/abnb.rb:43:in `save_reservation'
fail err=ActiveRecord::RecordNotUnique msg=PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "index_reservations_on_code"
DETAIL:  Key (code)=(XXX12345678) already exists.

Completed 500 Internal Server Error in 47ms (ActiveRecord: 3.2ms | Allocations: 32059)


  
ActiveRecord::RecordNotUnique (PG::UniqueViolation: ERROR:  duplicate key value violates unique constraint "index_reservations_on_code"
DETAIL:  Key (code)=(XXX12345678) already exists.
):
  
lib/payloads/abnb.rb:43:in `save_reservation'
lib/payloads/abnb.rb:24:in `process'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:42:55 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:30:in `guest'
  [1m[36mReservation Upsert (0.7ms)[0m  [1m[32mINSERT INTO "reservations" ("code","guest_id","start_date","end_date","adults","children","infants","guests","status","nights","currency","payout_price","security_price","total_price") VALUES ('XXX12345678', 3, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 2, 2, 0, 4, 'accepted', 4, 'AUD', '3800.00', '500.00', '4300.00') ON CONFLICT ("id") DO UPDATE SET "code"=excluded."code","guest_id"=excluded."guest_id","start_date"=excluded."start_date","end_date"=excluded."end_date","adults"=excluded."adults","children"=excluded."children","infants"=excluded."infants","guests"=excluded."guests","status"=excluded."status","nights"=excluded."nights","currency"=excluded."currency","payout_price"=excluded."payout_price","security_price"=excluded."security_price","total_price"=excluded."total_price" RETURNING "id"[0m
  ↳ lib/payloads/abnb.rb:43:in `save_reservation'
fail err=ActiveRecord::NotNullViolation msg=PG::NotNullViolation: ERROR:  null value in column "created_at" of relation "reservations" violates not-null constraint
DETAIL:  Failing row contains (3, XXX12345678, 3, 2021-03-12 00:00:00, 2021-03-16 00:00:00, 4, 4, 2, 2, 0, accepted, AUD, 3800.00, 500.00, 4300.00, null, null).

Completed 500 Internal Server Error in 68ms (ActiveRecord: 7.2ms | Allocations: 35743)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "created_at" of relation "reservations" violates not-null constraint
DETAIL:  Failing row contains (3, XXX12345678, 3, 2021-03-12 00:00:00, 2021-03-16 00:00:00, 4, 4, 2, 2, 0, accepted, AUD, 3800.00, 500.00, 4300.00, null, null).
):
  
lib/payloads/abnb.rb:43:in `save_reservation'
lib/payloads/abnb.rb:24:in `process'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:47:58 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:30:in `guest'
fail err=ArgumentError msg=unknown keyword: :record_timestamps
Completed 500 Internal Server Error in 73ms (ActiveRecord: 4.5ms | Allocations: 34139)


  
ArgumentError (unknown keyword: :record_timestamps):
  
lib/payloads/abnb.rb:43:in `save_reservation'
lib/payloads/abnb.rb:24:in `process'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 02:48:22 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:30:in `guest'
  [1m[36mReservation Upsert (0.8ms)[0m  [1m[32mINSERT INTO "reservations" ("code","guest_id","start_date","end_date","adults","children","infants","guests","status","nights","currency","payout_price","security_price","total_price","updated_at") VALUES ('XXX12345678', 3, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 2, 2, 0, 4, 'accepted', 4, 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 02:48:22.623061') ON CONFLICT ("code") DO UPDATE SET "guest_id"=excluded."guest_id","start_date"=excluded."start_date","end_date"=excluded."end_date","adults"=excluded."adults","children"=excluded."children","infants"=excluded."infants","guests"=excluded."guests","status"=excluded."status","nights"=excluded."nights","currency"=excluded."currency","payout_price"=excluded."payout_price","security_price"=excluded."security_price","total_price"=excluded."total_price","updated_at"=excluded."updated_at" RETURNING "id"[0m
  ↳ lib/payloads/abnb.rb:43:in `save_reservation'
fail err=ActiveRecord::NotNullViolation msg=PG::NotNullViolation: ERROR:  null value in column "created_at" of relation "reservations" violates not-null constraint
DETAIL:  Failing row contains (4, XXX12345678, 3, 2021-03-12 00:00:00, 2021-03-16 00:00:00, 4, 4, 2, 2, 0, accepted, AUD, 3800.00, 500.00, 4300.00, null, 2023-02-23 02:48:22.623061).

Completed 500 Internal Server Error in 62ms (ActiveRecord: 7.0ms | Allocations: 35757)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "created_at" of relation "reservations" violates not-null constraint
DETAIL:  Failing row contains (4, XXX12345678, 3, 2021-03-12 00:00:00, 2021-03-16 00:00:00, 4, 4, 2, 2, 0, accepted, AUD, 3800.00, 500.00, 4300.00, null, 2023-02-23 02:48:22.623061).
):
  
lib/payloads/abnb.rb:43:in `save_reservation'
lib/payloads/abnb.rb:24:in `process'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 03:01:33 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/abnb.rb:90:in `guest'
  [1m[36mGuest Load (0.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:90:in `guest'
  [1m[36mReservation Load (0.7ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:94:in `reservation'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/abnb.rb:22:in `process'
fail err=NoMethodError msg=undefined method `update!' for #<Class:0x0000aaaac7aff128>
Did you mean?  update
Completed 500 Internal Server Error in 98ms (ActiveRecord: 2.3ms | Allocations: 47254)


  
NoMethodError (undefined method `update!' for #<Class:0x0000aaaac7aff128>
Did you mean?  update):
  
lib/payloads/abnb.rb:72:in `update_reservation'
lib/payloads/abnb.rb:66:in `save_reservation'
lib/payloads/abnb.rb:25:in `block in process'
lib/payloads/abnb.rb:22:in `process'
app/services/reservation_services/create.rb:17:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 03:01:52 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/abnb.rb:90:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:90:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:94:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:72:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/abnb.rb:22:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 02:36:08", updated_at: "2023-02-23 02:36:08">
Completed 200 OK in 94ms (Views: 0.3ms | ActiveRecord: 7.9ms | Allocations: 46441)


Started POST "/reservations" for 172.19.0.1 at 2023-02-23 03:02:13 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/abnb.rb:90:in `guest'
  [1m[36mGuest Load (0.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:90:in `guest'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:94:in `reservation'
  [1m[36mReservation Load (0.9ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/abnb.rb:72:in `update_reservation'
  [1m[36mReservation Update (0.5ms)[0m  [1m[33mUPDATE "reservations" SET "status" = 'pending', "updated_at" = '2023-02-23 03:02:13.687902' WHERE "reservations"."id" = 1[0m
  ↳ lib/payloads/abnb.rb:72:in `update_reservation'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/abnb.rb:22:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 02:36:08", updated_at: "2023-02-23 02:36:08">
Completed 200 OK in 67ms (Views: 0.1ms | ActiveRecord: 4.2ms | Allocations: 33006)


Started POST "/reservations" for 172.19.0.1 at 2023-02-23 03:49:07 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
Completed 500 Internal Server Error in 49ms (ActiveRecord: 0.0ms | Allocations: 763)


  
Zeitwerk::NameError (expected file /airking_api/lib/payloads/base.rb to define constant Payloads::Base, but didn't):
  
lib/payloads/abnb.rb:5:in `<module:Payloads>'
lib/payloads/abnb.rb:3:in `<main>'
app/services/reservation_services/create.rb:11:in `<class:Create>'
app/services/reservation_services/create.rb:5:in `<module:ReservationServices>'
app/services/reservation_services/create.rb:3:in `<main>'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-23 03:49:49 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.8ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 02:36:08", updated_at: "2023-02-23 03:02:13">
Completed 200 OK in 116ms (Views: 0.2ms | ActiveRecord: 7.5ms | Allocations: 46590)


Started POST "/reservations" for 172.19.0.1 at 2023-02-23 03:57:25 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NameError msg=uninitialized constant ReservationServices::Create::ReservationError
Completed 500 Internal Server Error in 52ms (ActiveRecord: 0.0ms | Allocations: 31037)


  
NameError (uninitialized constant ReservationServices::Create::ReservationError):
  
app/services/reservation_services/create.rb:16:in `rescue in perform'
app/services/reservation_services/create.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.23.0.1 at 2023-02-23 03:58:34 +0000
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff7ca34568 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 359ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 57661)


Started POST "/reservations" for 172.23.0.1 at 2023-02-23 03:58:40 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 02:36:08", updated_at: "2023-02-23 03:02:13">
Completed 200 OK in 81ms (Views: 0.2ms | ActiveRecord: 5.8ms | Allocations: 47534)


Started POST "/reservations" for 172.23.0.1 at 2023-02-23 05:02:47 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mReservation Load (0.6ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 3 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 02:36:08", updated_at: "2023-02-23 03:02:13">
Completed 200 OK in 207ms (Views: 0.2ms | ActiveRecord: 2.9ms | Allocations: 49987)


Started POST "/reservations" for 172.23.0.1 at 2023-02-23 05:02:52 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne12_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne12_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (1.1ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne12_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:02:52.785662', '2023-02-23 05:02:52.785662') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 3 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 02:36:08", updated_at: "2023-02-23 03:02:13">
Completed 200 OK in 40ms (Views: 0.1ms | ActiveRecord: 4.8ms | Allocations: 34427)


  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:06:19 +0000
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne12_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne12_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `reservation'
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
fail err=NoMethodError msg=undefined method `reservation' for #<Guest:0x0000aaab0a277f08>
Did you mean?  reservations
               reservations=
Completed 500 Internal Server Error in 402ms (ActiveRecord: 5.9ms | Allocations: 76217)


  
NoMethodError (undefined method `reservation' for #<Guest:0x0000aaab0a277f08>
Did you mean?  reservations
               reservations=):
  
lib/payloads/base.rb:53:in `update_reservation'
lib/payloads/base.rb:47:in `save_reservation'
lib/payloads/base.rb:14:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:06:38 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne12_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne12_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `reservation'
  [1m[36mReservation Load (0.6ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:53:in `update_reservation'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 3 LIMIT 1[0m
  ↳ lib/payloads/base.rb:53:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 02:36:08", updated_at: "2023-02-23 03:02:13">
Completed 200 OK in 166ms (Views: 0.2ms | ActiveRecord: 6.0ms | Allocations: 51379)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:06:51 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne12_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne12_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Create (0.8ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne12_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:06:51.344881', '2023-02-23 05:06:51.344881') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `reservation'
  [1m[36mReservation Create (0.6ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345678', 5, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 05:06:51.353104', '2023-02-23 05:06:51.353104') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:35:in `create_reservation'
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 5, code: "XXX12345678", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:06:51", updated_at: "2023-02-23 05:06:51">
Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 3.5ms | Allocations: 33952)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:07:04 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne9_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:07:04.715108', '2023-02-23 05:07:04.715108') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:53:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:53:in `update_reservation'
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 5, code: "XXX12345678", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:06:51", updated_at: "2023-02-23 05:06:51">
Completed 200 OK in 30ms (Views: 0.1ms | ActiveRecord: 2.7ms | Allocations: 34354)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:09:53 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
fail err=NoMethodError msg=undefined method `reservation' for #<Guest:0x0000ffff5ceb7ba0>
Did you mean?  reservations
               reservations=
Completed 500 Internal Server Error in 87ms (ActiveRecord: 4.6ms | Allocations: 37725)


  
NoMethodError (undefined method `reservation' for #<Guest:0x0000ffff5ceb7ba0>
Did you mean?  reservations
               reservations=):
  
lib/payloads/base.rb:47:in `save_reservation'
lib/payloads/base.rb:14:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:10:21 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:59:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:59:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 6 LIMIT 11[0m
  ↳ lib/payloads/base.rb:14:in `p'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
fail err=NoMethodError msg=undefined method `reservation' for #<Guest:0x0000ffff541751c0>
Did you mean?  reservations
               reservations=
Completed 500 Internal Server Error in 75ms (ActiveRecord: 3.9ms | Allocations: 39362)


  
NoMethodError (undefined method `reservation' for #<Guest:0x0000ffff541751c0>
Did you mean?  reservations
               reservations=):
  
lib/payloads/base.rb:49:in `save_reservation'
lib/payloads/base.rb:16:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:14:25 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:63:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:63:in `guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:67:in `reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:59:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:59:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 5, code: "XXX12345678", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:06:51", updated_at: "2023-02-23 05:06:51">
Completed 200 OK in 122ms (Views: 0.2ms | ActiveRecord: 7.6ms | Allocations: 48234)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:14:53 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:63:in `guest'
  [1m[36mGuest Load (0.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:63:in `guest'
  [1m[36mReservation Load (0.6ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:67:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:59:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:59:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 5, code: "XXX12345678", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:06:51", updated_at: "2023-02-23 05:06:51">
Completed 200 OK in 38ms (Views: 0.1ms | ActiveRecord: 2.6ms | Allocations: 33390)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:15:05 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:64:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:60:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:60:in `update_reservation'
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 5, code: "XXX12345678", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:06:51", updated_at: "2023-02-23 05:06:51">
Completed 200 OK in 109ms (Views: 0.1ms | ActiveRecord: 5.9ms | Allocations: 48255)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:15:40 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:65:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:65:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:69:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `update_reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 6 LIMIT 11[0m
  ↳ lib/payloads/base.rb:18:in `p'
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 5, code: "XXX12345678", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:06:51", updated_at: "2023-02-23 05:06:51">
Completed 200 OK in 95ms (Views: 0.2ms | ActiveRecord: 6.1ms | Allocations: 49007)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:15:53 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:65:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:65:in `guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:69:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `update_reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 6[0m
  ↳ lib/payloads/base.rb:18:in `to_h'
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 5, code: "XXX12345678", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:06:51", updated_at: "2023-02-23 05:06:51">
Completed 200 OK in 112ms (Views: 0.1ms | ActiveRecord: 6.4ms | Allocations: 49145)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:16:27 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:65:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:65:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne9_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:16:27.493338', '2023-02-23 05:16:27.493338') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:35:in `create_guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:69:in `reservation'
  [1m[36mReservation Create (0.5ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345678', 7, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 05:16:27.501439', '2023-02-23 05:16:27.501439') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:39:in `create_reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 7[0m
  ↳ lib/payloads/base.rb:18:in `to_h'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
fail err=TypeError msg=wrong element type Reservation (expected array)
Completed 500 Internal Server Error in 48ms (ActiveRecord: 2.6ms | Allocations: 35655)


  
TypeError (wrong element type Reservation (expected array)):
  
lib/payloads/base.rb:18:in `to_h'
lib/payloads/base.rb:18:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:16:43 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:65:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:65:in `guest'
  [1m[36mGuest Create (0.3ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne9_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:16:44.015307', '2023-02-23 05:16:44.015307') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:35:in `create_guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:69:in `reservation'
  [1m[36mReservation Create (0.5ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345678', 8, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 05:16:44.036402', '2023-02-23 05:16:44.036402') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:39:in `create_reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 8 LIMIT 11[0m
  ↳ lib/payloads/base.rb:18:in `p'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 7, code: "XXX12345678", guest_id: 8, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:16:44", updated_at: "2023-02-23 05:16:44">
Completed 200 OK in 110ms (Views: 0.1ms | ActiveRecord: 7.7ms | Allocations: 49482)


Started POST "/reservations" for 172.24.0.1 at 2023-02-23 05:19:16 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 7 LIMIT 1[0m
  ↳ lib/payloads/base.rb:53:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 8 LIMIT 1[0m
  ↳ lib/payloads/base.rb:53:in `update_reservation'
  [1m[36mReservation Update (0.4ms)[0m  [1m[33mUPDATE "reservations" SET "status" = 'accepted', "updated_at" = '2023-02-23 05:19:16.628853' WHERE "reservations"."id" = 7[0m
  ↳ lib/payloads/base.rb:53:in `update_reservation'
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 7, code: "XXX12345678", guest_id: 8, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:16:44", updated_at: "2023-02-23 05:19:16">
Completed 200 OK in 123ms (Views: 0.6ms | ActiveRecord: 11.2ms | Allocations: 48926)


  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (5136.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking"[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (16.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking"[0m
  [1m[35m (15.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_db_test"[0m
  [1m[35m (54.7ms)[0m  [1m[35mCREATE DATABASE "airking" ENCODING = 'utf8'[0m
  [1m[35m (45.3ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (5.4ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (2.9ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 05:22:10.614195', '2023-02-23 05:22:10.614195') RETURNING "key"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '9036189701c7197313b8a9006cf29510c590dab0', '2023-02-23 05:22:10.624571', '2023-02-23 05:22:10.624571') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (2.8ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (3.1ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 05:22:10.681808', '2023-02-23 05:22:10.681808') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-02-23 05:22:10.687852' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '9036189701c7197313b8a9006cf29510c590dab0', '2023-02-23 05:22:10.694986', '2023-02-23 05:22:10.694986') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:23:28 +0000
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:57:in `guest'
  [1m[36mGuest Create (0.4ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne9_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:23:28.816209', '2023-02-23 05:23:28.816209') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:61:in `reservation'
  [1m[36mReservation Create (0.6ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345678', 1, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 05:23:28.861929', '2023-02-23 05:23:28.861929') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:35:in `create_reservation'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 421ms (Views: 0.2ms | ActiveRecord: 7.4ms | Allocations: 79588)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:39:41 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne91_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (1.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne91_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.7ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne91_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:39:41.166312', '2023-02-23 05:39:41.166312') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 110ms (Views: 0.4ms | ActiveRecord: 5.9ms | Allocations: 48854)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:39:55 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne91_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne91_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 102ms (Views: 0.1ms | ActiveRecord: 7.7ms | Allocations: 48192)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:40:01 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.4ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne911_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:40:01.271264', '2023-02-23 05:40:01.271264') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 31ms (Views: 0.1ms | ActiveRecord: 3.5ms | Allocations: 34389)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:40:38 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 92ms (Views: 0.3ms | ActiveRecord: 4.6ms | Allocations: 48162)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:41:24 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 89ms (Views: 0.1ms | ActiveRecord: 5.1ms | Allocations: 48216)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:41:25 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 35ms (Views: 0.1ms | ActiveRecord: 2.0ms | Allocations: 33345)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:41:26 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 1.5ms | Allocations: 33322)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:41:27 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 29ms (Views: 0.1ms | ActiveRecord: 2.1ms | Allocations: 33322)


Started POST "/reservations" for 172.25.0.1 at 2023-02-23 05:41:33 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9211_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9211_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Create (0.3ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne9211_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:41:33.471851', '2023-02-23 05:41:33.471851') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:64:in `update_reservation'
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:23:28", updated_at: "2023-02-23 05:23:28">
Completed 200 OK in 35ms (Views: 0.1ms | ActiveRecord: 3.7ms | Allocations: 34393)


  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (16.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking"[0m
  [1m[35m (12.8ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_db_test"[0m
  [1m[35m (55.8ms)[0m  [1m[35mCREATE DATABASE "airking" ENCODING = 'utf8'[0m
  [1m[35m (49.7ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (3.3ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 05:43:27.749251', '2023-02-23 05:43:27.749251') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '9036189701c7197313b8a9006cf29510c590dab0', '2023-02-23 05:43:27.759013', '2023-02-23 05:43:27.759013') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (5.3ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (3.2ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 05:43:27.815428', '2023-02-23 05:43:27.815428') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-02-23 05:43:27.821372' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '9036189701c7197313b8a9006cf29510c590dab0', '2023-02-23 05:43:27.829331', '2023-02-23 05:43:27.829331') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.26.0.1 at 2023-02-23 05:43:42 +0000
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9211_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9211_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne9211_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:43:42.733450', '2023-02-23 05:43:42.733450') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Create (0.6ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345678', 1, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 05:43:42.757343', '2023-02-23 05:43:42.757343') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:35:in `create_reservation'
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:43:42", updated_at: "2023-02-23 05:43:42">
Completed 200 OK in 378ms (Views: 0.1ms | ActiveRecord: 6.6ms | Allocations: 78171)


Started POST "/reservations" for 172.26.0.1 at 2023-02-23 05:43:57 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.3ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne9_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '["639123456789", "639123456789"]', '2023-02-23 05:43:57.960351', '2023-02-23 05:43:57.960351') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation id: 1, code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:43:42", updated_at: "2023-02-23 05:43:42">
Completed 200 OK in 50ms (Views: 0.1ms | ActiveRecord: 2.7ms | Allocations: 35887)


  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (15.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking"[0m
  [1m[35m (15.2ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_db_test"[0m
  [1m[35m (53.0ms)[0m  [1m[35mCREATE DATABASE "airking" ENCODING = 'utf8'[0m
  [1m[35m (47.8ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (4.5ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (2.9ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.3ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (3.0ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 05:47:09.885655', '2023-02-23 05:47:09.885655') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '9036189701c7197313b8a9006cf29510c590dab0', '2023-02-23 05:47:09.897537', '2023-02-23 05:47:09.897537') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (5.6ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (3.4ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (3.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 05:47:09.954601', '2023-02-23 05:47:09.954601') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-02-23 05:47:09.961964' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '9036189701c7197313b8a9006cf29510c590dab0', '2023-02-23 05:47:09.968360', '2023-02-23 05:47:09.968360') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(5505396536542938105)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(5505396536542938105)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (54.9ms)[0m  [1m[35mCREATE DATABASE "airking_dev" ENCODING = 'utf8'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35m (5.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateGuests (20230223014841)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.4ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text[] DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20230223014841') RETURNING "version"[0m
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateReservations (20230223015218)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "reservations" ("code" character varying NOT NULL, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ('20230223015218') RETURNING "version"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-23 05:49:12.702011', '2023-02-23 05:49:12.702011') RETURNING "key"[0m
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 05:49:48 +0000
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne9_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne9_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne9_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 05:49:48.904506', '2023-02-23 05:49:48.904506') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Create (0.7ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345678', 1, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 05:49:48.929118', '2023-02-23 05:49:48.929118')[0m
  ↳ lib/payloads/base.rb:35:in `create_reservation'
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation code: "XXX12345678", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:49:48", updated_at: "2023-02-23 05:49:48">
Completed 200 OK in 378ms (Views: 0.1ms | ActiveRecord: 6.2ms | Allocations: 77792)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 05:49:53 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne19_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne19_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.2ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne19_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 05:49:53.908140', '2023-02-23 05:49:53.908140') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
fail err=ActiveRecord::UnknownPrimaryKey msg=Unknown primary key for table reservations in model Reservation.
Completed 500 Internal Server Error in 42ms (ActiveRecord: 1.8ms | Allocations: 33062)


  
ActiveRecord::UnknownPrimaryKey (Unknown primary key for table reservations in model Reservation.):
  
lib/payloads/base.rb:54:in `update_reservation'
lib/payloads/base.rb:48:in `save_reservation'
lib/payloads/base.rb:14:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 05:50:24 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345678", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne19_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne19_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.2ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne19_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 05:50:24.698498', '2023-02-23 05:50:24.698498') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
fail err=ActiveRecord::UnknownPrimaryKey msg=Unknown primary key for table reservations in model Reservation.
Completed 500 Internal Server Error in 30ms (ActiveRecord: 1.5ms | Allocations: 32229)


  
ActiveRecord::UnknownPrimaryKey (Unknown primary key for table reservations in model Reservation.):
  
lib/payloads/base.rb:54:in `update_reservation'
lib/payloads/base.rb:48:in `save_reservation'
lib/payloads/base.rb:14:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 05:51:04 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne19_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"accepted", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.8ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne19_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.3ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne19_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 05:51:04.871665', '2023-02-23 05:51:04.871665') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mReservation Create (0.4ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('XXX12345679', 4, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 05:51:04.878471', '2023-02-23 05:51:04.878471')[0m
  ↳ lib/payloads/base.rb:35:in `create_reservation'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation code: "XXX12345679", guest_id: 4, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:51:04", updated_at: "2023-02-23 05:51:04">
Completed 200 OK in 33ms (Views: 0.2ms | ActiveRecord: 3.3ms | Allocations: 33430)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 05:51:23 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne19_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne19_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
fail err=ActiveRecord::UnknownPrimaryKey msg=Unknown primary key for table reservations in model Reservation.
Completed 500 Internal Server Error in 25ms (ActiveRecord: 1.4ms | Allocations: 31231)


  
ActiveRecord::UnknownPrimaryKey (Unknown primary key for table reservations in model Reservation.):
  
lib/payloads/base.rb:54:in `update_reservation'
lib/payloads/base.rb:48:in `save_reservation'
lib/payloads/base.rb:14:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 05:52:25 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne19_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne19_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m  [["code", "XXX12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 4 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mReservation Update (0.7ms)[0m  [1m[33mUPDATE "reservations" SET "status" = 'pending', "updated_at" = '2023-02-23 05:52:25.265153' WHERE "reservations"."code" = 'XXX12345679'[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation code: "XXX12345679", guest_id: 4, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:51:04", updated_at: "2023-02-23 05:52:25">
Completed 200 OK in 105ms (Views: 0.2ms | ActiveRecord: 7.4ms | Allocations: 48798)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 05:52:39 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne191_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne191_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.3ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne191_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 05:52:39.616800', '2023-02-23 05:52:39.616800') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m  [["code", "XXX12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 4 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (0.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation code: "XXX12345679", guest_id: 4, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:51:04", updated_at: "2023-02-23 05:52:25">
Completed 200 OK in 35ms (Views: 0.2ms | ActiveRecord: 2.7ms | Allocations: 34298)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 05:53:23 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:58:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne1911_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 05:53:23.574478', '2023-02-23 05:53:23.574478') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:31:in `create_guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m  [["code", "XXX12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 4 LIMIT 1[0m
  ↳ lib/payloads/base.rb:54:in `update_reservation'
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation code: "XXX12345679", guest_id: 4, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:51:04", updated_at: "2023-02-23 05:52:25">
Completed 200 OK in 37ms (Views: 0.2ms | ActiveRecord: 2.8ms | Allocations: 34222)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:01:45 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"XXX12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (1.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:37:in `associated_to_user?'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'XXX12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `reservation'
complete out=#<Reservation code: "XXX12345679", guest_id: 4, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 05:51:04", updated_at: "2023-02-23 05:52:25">
Completed 200 OK in 99ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 45687)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:02:05 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:37:in `associated_to_user?'
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
  [1m[36mReservation Load (0.7ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `reservation'
complete out=nil
Completed 200 OK in 32ms (Views: 0.1ms | ActiveRecord: 2.3ms | Allocations: 31593)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:03:31 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:67:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:67:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:36:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:71:in `reservation'
  [1m[36mReservation Create (0.7ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('YYY12345679', 6, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 06:03:32.060902', '2023-02-23 06:03:32.060902') RETURNING "code"[0m
  ↳ lib/payloads/base.rb:44:in `create_reservation'
  [1m[35m (1.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation code: "YYY12345679", guest_id: 6, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 06:03:32", updated_at: "2023-02-23 06:03:32">
Completed 200 OK in 109ms (Views: 0.1ms | ActiveRecord: 8.3ms | Allocations: 47296)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:03:37 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:67:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:67:in `guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:36:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:71:in `reservation'
  [1m[36mCACHE Reservation Load (0.1ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' LIMIT 1[0m  [["code", "YYY12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:63:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:63:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Reservation code: "YYY12345679", guest_id: 6, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 06:03:32", updated_at: "2023-02-23 06:03:32">
Completed 200 OK in 35ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 34264)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:03:45 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:67:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'bob_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:67:in `guest'
  [1m[36mGuest Create (0.6ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('bob_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 06:03:45.057845', '2023-02-23 06:03:45.057845') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:40:in `create_guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 7 LIMIT 1[0m
  ↳ lib/payloads/base.rb:36:in `associated_to_user?'
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
fail err=ReservationAssociationError msg=ReservationAssociationError
Completed 500 Internal Server Error in 50ms (ActiveRecord: 1.9ms | Allocations: 32246)


  
ReservationAssociationError (ReservationAssociationError):
  
lib/payloads/base.rb:14:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:06:26 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:67:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'bob_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:67:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('bob_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 06:06:26.771130', '2023-02-23 06:06:26.771130') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:40:in `create_guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 8 LIMIT 1[0m
  ↳ lib/payloads/base.rb:36:in `associated_to_user?'
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:11:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000aaab14a55658 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 137ms (Views: 0.2ms | ActiveRecord: 7.2ms | Allocations: 38981)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:12:47 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `fetch_nested' for nil:NilClass
Completed 500 Internal Server Error in 71ms (ActiveRecord: 0.0ms | Allocations: 30825)


  
NoMethodError (undefined method `fetch_nested' for nil:NilClass):
  
lib/payloads/abnb.rb:11:in `guest_email'
lib/payloads/base.rb:67:in `guest'
lib/payloads/base.rb:12:in `block in process'
lib/payloads/base.rb:11:in `process'
app/services/reservation_services/create.rb:15:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:13:51 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff801be538 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 66ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 30408)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:14:26 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab14c59990 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 66ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 30348)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:14:38 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'bob_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('bob_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 06:14:38.245441', '2023-02-23 06:14:38.245441') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:41:in `create_guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 9 LIMIT 1[0m
  ↳ lib/payloads/base.rb:37:in `associated_to_user?'
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80259128 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 69ms (Views: 0.2ms | ActiveRecord: 8.9ms | Allocations: 37825)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:15:09 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab14e6cbd8 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 92ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 33389)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:17:51 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'bob_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('bob_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 06:17:51.174140', '2023-02-23 06:17:51.174140') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:41:in `create_guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 10 LIMIT 1[0m
  ↳ lib/payloads/base.rb:37:in `associated_to_user?'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80241d98 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 107ms (Views: 0.3ms | ActiveRecord: 6.4ms | Allocations: 38435)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:26:05 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (1.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'bob_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Create (0.8ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('bob_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 06:26:05.595315', '2023-02-23 06:26:05.595315') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:41:in `create_guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 11 LIMIT 1[0m
  ↳ lib/payloads/base.rb:37:in `associated_to_user?'
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000aaab12b6f5e0 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 115ms (Views: 0.4ms | ActiveRecord: 3.4ms | Allocations: 38608)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:26:10 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["must be filled"]}}
Completed 500 Internal Server Error in 11ms (ActiveRecord: 0.0ms | Allocations: 29155)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:27:36 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["must be filled"]}}
Completed 500 Internal Server Error in 73ms (ActiveRecord: 0.0ms | Allocations: 30516)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:27:39 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'bob_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('bob_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 06:27:39.747853', '2023-02-23 06:27:39.747853') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:41:in `create_guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 12 LIMIT 1[0m
  ↳ lib/payloads/base.rb:37:in `associated_to_user?'
  [1m[35m (0.6ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8030d650 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 72ms (Views: 0.2ms | ActiveRecord: 12.0ms | Allocations: 37608)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:33:39 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `begin_transaction' for #<Class:0x0000aaab14e94020>
Completed 500 Internal Server Error in 72ms (ActiveRecord: 0.0ms | Allocations: 33452)


  
NoMethodError (undefined method `begin_transaction' for #<Class:0x0000aaab14e94020>):
  
lib/payloads/base.rb:12:in `process'
app/services/reservation_services/create.rb:19:in `block in perform'
app/services/reservation_services/create.rb:13:in `each'
app/services/reservation_services/create.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:33:44 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'bob_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('bob_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 06:33:44.664085', '2023-02-23 06:33:44.664085') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:41:in `create_guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 13 LIMIT 1[0m
  ↳ lib/payloads/base.rb:37:in `associated_to_user?'
  [1m[35m (1.0ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8042bbb8 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 105ms (Views: 0.2ms | ActiveRecord: 8.6ms | Allocations: 39189)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:33:56 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["must be filled"]}}
Completed 500 Internal Server Error in 10ms (ActiveRecord: 0.0ms | Allocations: 29151)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:42:36 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Load (1.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'bob_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:68:in `guest'
  [1m[36mGuest Create (0.6ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('bob_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-23 06:42:36.473051', '2023-02-23 06:42:36.473051') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:41:in `create_guest'
  [1m[36mReservation Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 14 LIMIT 1[0m
  ↳ lib/payloads/base.rb:37:in `associated_to_user?'
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff800ac780 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 39ms (Views: 1.2ms | ActiveRecord: 3.4ms | Allocations: 32369)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:49:42 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}}
Completed 500 Internal Server Error in 89ms (ActiveRecord: 0.0ms | Allocations: 31066)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:50:25 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}}
Completed 500 Internal Server Error in 79ms (ActiveRecord: 0.0ms | Allocations: 31933)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:54:27 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}}
Completed 500 Internal Server Error in 68ms (ActiveRecord: 0.0ms | Allocations: 32773)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:55:07 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}}
Completed 500 Internal Server Error in 72ms (ActiveRecord: 0.0ms | Allocations: 31504)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:55:50 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}}
Completed 500 Internal Server Error in 90ms (ActiveRecord: 0.0ms | Allocations: 31911)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:57:02 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `messages' for #<Dry::Schema::Result:0x0000ffff80143810>
Did you mean?  message_set
Completed 500 Internal Server Error in 54ms (ActiveRecord: 0.0ms | Allocations: 31122)


  
NoMethodError (undefined method `messages' for #<Dry::Schema::Result:0x0000ffff80143810>
Did you mean?  message_set):
  
lib/payloads/base.rb:8:in `initialize'
app/services/reservation_services/create.rb:14:in `new'
app/services/reservation_services/create.rb:14:in `block in perform'
app/services/reservation_services/create.rb:13:in `each'
app/services/reservation_services/create.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 06:58:00 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=NoMethodError msg=undefined method `messages' for #<Dry::Schema::Result:0x0000ffff80453618>
Did you mean?  message_set
Completed 500 Internal Server Error in 52ms (ActiveRecord: 0.0ms | Allocations: 31110)


  
NoMethodError (undefined method `messages' for #<Dry::Schema::Result:0x0000ffff80453618>
Did you mean?  message_set):
  
lib/payloads/base.rb:24:in `errors'
app/services/reservation_services/create.rb:16:in `block in perform'
app/services/reservation_services/create.rb:13:in `each'
app/services/reservation_services/create.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:00:59 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}}
Completed 500 Internal Server Error in 70ms (ActiveRecord: 0.0ms | Allocations: 31951)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:02:13 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}
Completed 500 Internal Server Error in 69ms (ActiveRecord: 0.0ms | Allocations: 31949)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:02:49 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:guest_details=>{:localized_description=>["localized_description must be filled"]}}
Completed 500 Internal Server Error in 21ms (ActiveRecord: 0.0ms | Allocations: 29732)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:03:17 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"bob_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_details=>{:localized_description=>["localized_description must be filled"]}}}
Completed 500 Internal Server Error in 59ms (ActiveRecord: 0.0ms | Allocations: 31181)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:03:37 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}}
Completed 500 Internal Server Error in 12ms (ActiveRecord: 0.0ms | Allocations: 30517)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:08:37 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservations"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}, "reservation"=>{}}
complete out={:reservations=>{:code=>["code is not allowed"], :start_date=>["start_date is not allowed"], :end_date=>["end_date is not allowed"], :expected_payout_amount=>["expected_payout_amount is not allowed"], :guest_details=>{:localized_description=>["localized_description is not allowed"], :number_of_adults=>["number_of_adults is not allowed"], :number_of_children=>["number_of_children is not allowed"], :number_of_infants=>["number_of_infants is not allowed"]}, :guest_email=>["guest_email is not allowed"], :guest_first_name=>["guest_first_name is not allowed"], :guest_last_name=>["guest_last_name is not allowed"], :guest_phone_numbers=>["guest_phone_numbers is not allowed"], :listing_security_price_accurate=>["listing_security_price_accurate is not allowed"], :host_currency=>["host_currency is not allowed"], :nights=>["nights is not allowed"], :number_of_guests=>["number_of_guests is not allowed"], :status_type=>["status_type is not allowed"], :total_paid_amount_accurate=>["total_paid_amount_accurate is not allowed"]}, :reservation=>{:code=>["code is missing"], :start_date=>["start_date is missing"], :end_date=>["end_date is missing"], :expected_payout_amount=>["expected_payout_amount is missing"], :guest_details=>["guest_details is missing"], :guest_email=>["guest_email is missing"], :guest_first_name=>["guest_first_name is missing"], :guest_last_name=>["guest_last_name is missing"], :guest_phone_numbers=>["guest_phone_numbers is missing"], :listing_security_price_accurate=>["listing_security_price_accurate is missing"], :host_currency=>["host_currency is missing"], :nights=>["nights is missing"], :number_of_guests=>["number_of_guests is missing"], :status_type=>["status_type is missing"], :total_paid_amount_accurate=>["total_paid_amount_accurate is missing"]}}
Completed 500 Internal Server Error in 79ms (ActiveRecord: 4.7ms | Allocations: 50878)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:09:06 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{}}
complete out={:reservation=>{:code=>["code is missing"], :start_date=>["start_date is missing"], :end_date=>["end_date is missing"], :expected_payout_amount=>["expected_payout_amount is missing"], :guest_details=>["guest_details is missing"], :guest_email=>["guest_email is missing"], :guest_first_name=>["guest_first_name is missing"], :guest_last_name=>["guest_last_name is missing"], :guest_phone_numbers=>["guest_phone_numbers is missing"], :listing_security_price_accurate=>["listing_security_price_accurate is missing"], :host_currency=>["host_currency is missing"], :nights=>["nights is missing"], :number_of_guests=>["number_of_guests is missing"], :status_type=>["status_type is missing"], :total_paid_amount_accurate=>["total_paid_amount_accurate is missing"]}}
Completed 500 Internal Server Error in 13ms (ActiveRecord: 0.0ms | Allocations: 34533)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:09:20 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out={:reservation=>{:guest_email=>["guest_email must be filled"], :guest_first_name=>["guest_first_name must be filled"]}}
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.0ms | Allocations: 29640)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:10:55 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=ArgumentError msg=unknown keyword: :reservation
Completed 500 Internal Server Error in 95ms (ActiveRecord: 0.0ms | Allocations: 30951)


  
ArgumentError (unknown keyword: :reservation):
  
lib/utils/error_responses/base.rb:26:in `create_errors'
app/services/reservation_services/create.rb:17:in `block in perform'
app/services/reservation_services/create.rb:13:in `each'
app/services/reservation_services/create.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:11:53 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=ArgumentError msg=unknown keyword: :reservation
Completed 500 Internal Server Error in 69ms (ActiveRecord: 0.0ms | Allocations: 30836)


  
ArgumentError (unknown keyword: :reservation):
  
lib/utils/error_responses/base.rb:26:in `create_errors'
app/services/reservation_services/create.rb:17:in `block in perform'
app/services/reservation_services/create.rb:13:in `each'
app/services/reservation_services/create.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:12:33 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=ArgumentError msg=unknown keyword: :reservation
Completed 500 Internal Server Error in 70ms (ActiveRecord: 0.0ms | Allocations: 30832)


  
ArgumentError (unknown keyword: :reservation):
  
lib/utils/error_responses/base.rb:26:in `create_errors'
app/services/reservation_services/create.rb:17:in `block in perform'
app/services/reservation_services/create.rb:13:in `each'
app/services/reservation_services/create.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:13:01 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
fail err=ArgumentError msg=unknown keyword: :reservation
Completed 500 Internal Server Error in 71ms (ActiveRecord: 0.0ms | Allocations: 30978)


  
ArgumentError (unknown keyword: :reservation):
  
lib/utils/error_responses/base.rb:26:in `create_errors'
app/services/reservation_services/create.rb:17:in `block in perform'
app/services/reservation_services/create.rb:13:in `each'
app/services/reservation_services/create.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:13:29 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff74a4e4c0 @errors=[], @http_code=409>
Completed 409 Conflict in 64ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 31201)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:14:46 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff802b0cc0 @errors=[], @http_code=409>
Completed 409 Conflict in 84ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 31221)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:15:07 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab14c6cb08 @errors=[], @http_code=409>
Completed 409 Conflict in 61ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 31212)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:15:45 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80139a68 @errors=[], @http_code=409>
Completed 409 Conflict in 57ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 31227)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:15:56 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8c061ee0 @errors=[], @http_code=409>
Completed 409 Conflict in 70ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 31214)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:17:09 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff74b1fc50 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>[:guest_email, ["guest_email must be filled"]], :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 72ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 31311)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:17:32 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"YYY12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (1.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345679' LIMIT 1[0m  [["code", "YYY12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff802525a8 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 88ms (Views: 0.2ms | ActiveRecord: 9.6ms | Allocations: 47229)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:17:54 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.6ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (0.8ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('HHH12345679', 6, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-23 07:17:54.658643', '2023-02-23 07:17:54.658643') RETURNING "code"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff803078b8 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 104ms (Views: 0.2ms | ActiveRecord: 7.6ms | Allocations: 47258)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:18:02 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m  [["code", "HHH12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff801fcdb0 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 113ms (Views: 0.1ms | ActiveRecord: 5.6ms | Allocations: 48431)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:18:04 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m  [["code", "HHH12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80056678 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 56ms (Views: 0.9ms | ActiveRecord: 2.2ms | Allocations: 33779)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:18:18 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservations"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}, "reservation"=>{}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80198798 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>[:code, ["code is not allowed"]], :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>[:code, ["code is missing"]], :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 39ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 49539)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:18:24 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m  [["code", "HHH12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff74a535d8 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 38ms (Views: 0.1ms | ActiveRecord: 2.7ms | Allocations: 33774)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:18:58 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m  [["code", "HHH12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff802c99f0 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 110ms (Views: 0.2ms | ActiveRecord: 5.0ms | Allocations: 48422)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:19:22 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m  [["code", "HHH12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation code: "HHH12345679", guest_id: 6, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 07:17:54", updated_at: "2023-02-23 07:17:54">
Completed 200 OK in 104ms (Views: 0.3ms | ActiveRecord: 6.4ms | Allocations: 48406)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:19:27 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80405da0 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>[:guest_first_name, ["guest_first_name must be filled"]], :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 28ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 29450)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:25:34 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff74a01170 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 73ms (Views: 0.5ms | ActiveRecord: 0.0ms | Allocations: 30842)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:25:47 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8c083f90 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"localized_description must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 24ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 29294)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:25:55 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8014f160 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_last_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 13ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 29755)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:29:32 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m  [["code", "HHH12345679"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation code: "HHH12345679", guest_id: 6, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-23 07:17:54", updated_at: "2023-02-23 07:17:54">
Completed 200 OK in 149ms (Views: 0.5ms | ActiveRecord: 13.4ms | Allocations: 48805)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:29:38 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8011ff00 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 67ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 29500)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:29:40 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff74a052c0 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 10ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 29685)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:29:46 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8c01f1f8 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 15ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 29688)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:30:29 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff74b72720 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_last_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 67ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 31330)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:30:39 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff803fb9b8 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_last_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 79ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 31321)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:40:04 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab150aea68 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation_code is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"start_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"end_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"nights is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"first_name is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"last_name is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"phone is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"email is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 38ms (Views: 1.5ms | ActiveRecord: 3.9ms | Allocations: 50031)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:44:59 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff74b61b28 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation_code is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"start_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"end_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"nights is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"first_name is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"last_name is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"phone is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"email is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 67ms (Views: 0.4ms | ActiveRecord: 3.0ms | Allocations: 51119)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:45:21 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab14ca7758 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"start_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"end_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"nights is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 115ms (Views: 0.3ms | ActiveRecord: 1.6ms | Allocations: 81332)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:45:23 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab14c2ddb8 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"start_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"end_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"nights is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 29ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 78971)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:50:22 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80342d50 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"start_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"end_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"nights is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 91ms (Views: 0.4ms | ActiveRecord: 2.7ms | Allocations: 80666)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:51:02 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff800764a0 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"start_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"end_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"nights is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 88ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 80525)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:51:58 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (1.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.7ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789}', '2023-02-23 07:51:58.527376', '2023-02-23 07:51:58.527376') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' AND "reservations"."guest_id" != 15 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (2.2ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('YYY12345678', 15, '2021-04-14 00:00:00', '2021-04-18 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '4200.00', '500', '4700.00', '2023-02-23 07:51:58.545463', '2023-02-23 07:51:58.545463') RETURNING "code"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation code: "YYY12345678", guest_id: 15, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-23 07:51:58", updated_at: "2023-02-23 07:51:58">
Completed 200 OK in 121ms (Views: 0.3ms | ActiveRecord: 16.9ms | Allocations: 34172)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:52:14 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff800ae760 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 17ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 15713)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:52:50 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8c061e68 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"start_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"end_date is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"nights is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guests is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"adults is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"children is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"infants is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"currency is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"payout_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"security_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_price is not allowed", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 122ms (Views: 0.5ms | ActiveRecord: 1.9ms | Allocations: 81037)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 07:53:56 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff801436a8 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 115ms (Views: 0.4ms | ActiveRecord: 2.9ms | Allocations: 17577)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 08:53:46 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab14c596e8 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 121ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 17317)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:14:51 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80146e20 @errors=[{:attribute=>"", :code=>:unrecognized_payload, :detail=>"The payload passed in was not recognized.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 89ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 42468)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:16:10 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NameError msg=undefined local variable or method `payload' for #<ReservationServices::Create:0x0000ffff80025be0>
Did you mean?  @payload
Completed 500 Internal Server Error in 49ms (ActiveRecord: 3.3ms | Allocations: 18906)


  
NameError (undefined local variable or method `payload' for #<ReservationServices::Create:0x0000ffff80025be0>
Did you mean?  @payload):
  
app/services/reservation_services/create.rb:17:in `block in perform'
app/services/reservation_services/create.rb:14:in `each'
app/services/reservation_services/create.rb:14:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:16:20 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=ArgumentError msg=unknown keyword: :detail
Completed 500 Internal Server Error in 60ms (ActiveRecord: 1.4ms | Allocations: 44542)


  
ArgumentError (unknown keyword: :detail):
  
lib/utils/error_responses/base.rb:26:in `create_errors'
app/services/reservation_services/create.rb:20:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:17:24 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff801f47a0 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 74ms (Views: 0.3ms | ActiveRecord: 1.8ms | Allocations: 45483)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:17:51 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"ZZZ12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'ZZZ12345678' AND "reservations"."guest_id" != 15 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'ZZZ12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (0.8ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('ZZZ12345678', 15, '2021-04-14 00:00:00', '2021-04-18 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '4200.00', '500', '4700.00', '2023-02-23 09:17:51.966989', '2023-02-23 09:17:51.966989') RETURNING "code"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation code: "ZZZ12345678", guest_id: 15, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-23 09:17:51", updated_at: "2023-02-23 09:17:51">
Completed 200 OK in 48ms (Views: 0.1ms | ActiveRecord: 5.8ms | Allocations: 31202)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:18:05 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"ZZZ12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff80451520 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 19ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 43807)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:26:27 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"ZZZ12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab15016da8 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 91ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 47864)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:27:47 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"ZZZ12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff800d3600 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 83ms (Views: 0.4ms | ActiveRecord: 3.5ms | Allocations: 47954)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:28:01 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"ZZZ12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.6ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('mrcbstmnte@bnb.com', 'Marc', 'Bee', '{639123456789}', '2023-02-23 09:28:01.811032', '2023-02-23 09:28:01.811032') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'ZZZ12345678' AND "reservations"."guest_id" != 16 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[35m (0.5ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff749f6db0 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 48ms (Views: 0.1ms | ActiveRecord: 5.1ms | Allocations: 22882)


Started POST "/reservations" for 172.30.0.1 at 2023-02-23 09:28:07 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (1.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.4ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('mrcbstmnte@bnb.com', 'Marc', 'Bee', '{639123456789}', '2023-02-23 09:28:07.859924', '2023-02-23 09:28:07.859924') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (0.8ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('Wilson', 17, '2021-04-14 00:00:00', '2021-04-18 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '4200.00', '500', '4700.00', '2023-02-23 09:28:07.881917', '2023-02-23 09:28:07.881917') RETURNING "code"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation code: "Wilson", guest_id: 17, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-23 09:28:07", updated_at: "2023-02-23 09:28:07">
Completed 200 OK in 51ms (Views: 0.2ms | ActiveRecord: 4.6ms | Allocations: 27665)


  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.19.0.1 at 2023-02-24 02:35:22 +0000
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Load (1.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mReservation Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m  [["code", "Wilson"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
fail err=TypeError msg=no implicit conversion of Reservation into Hash
Completed 500 Internal Server Error in 406ms (ActiveRecord: 6.4ms | Allocations: 62952)


  
TypeError (no implicit conversion of Reservation into Hash):
  
lib/payloads/base.rb:24:in `merge'
lib/payloads/base.rb:24:in `process'
app/services/reservation_services/create.rb:21:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-24 02:35:40 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m  [["code", "Wilson"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
fail err=NoMethodError msg=undefined method `to_h' for #<Guest:0x0000ffff841fe0d0>
Did you mean?  to_s
Completed 500 Internal Server Error in 83ms (ActiveRecord: 5.2ms | Allocations: 35022)


  
NoMethodError (undefined method `to_h' for #<Guest:0x0000ffff841fe0d0>
Did you mean?  to_s):
  
lib/payloads/base.rb:23:in `process'
app/services/reservation_services/create.rb:21:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-24 02:35:48 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m  [["code", "Wilson"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
fail err=NoMethodError msg=undefined method `to_h' for #<Reservation:0x0000ffff8cbd3ad0>
Did you mean?  to_s
Completed 500 Internal Server Error in 78ms (ActiveRecord: 4.3ms | Allocations: 35716)


  
NoMethodError (undefined method `to_h' for #<Reservation:0x0000ffff8cbd3ad0>
Did you mean?  to_s):
  
lib/payloads/base.rb:24:in `process'
app/services/reservation_services/create.rb:21:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-24 02:35:57 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m  [["code", "Wilson"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
fail err=TypeError msg=no implicit conversion of Reservation into Hash
Completed 500 Internal Server Error in 76ms (ActiveRecord: 3.9ms | Allocations: 32949)


  
TypeError (no implicit conversion of Reservation into Hash):
  
lib/payloads/base.rb:24:in `merge'
lib/payloads/base.rb:24:in `process'
app/services/reservation_services/create.rb:21:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-24 02:37:18 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m  [["code", "Wilson"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out={:guest=>{"id"=>17, "email"=>"mrcbstmnte@bnb.com", "first_name"=>"Marc", "last_name"=>"Bee", "phone_numbers"=>["639123456789"], "created_at"=>"2023-02-23T09:28:07.859Z", "updated_at"=>"2023-02-23T09:28:07.859Z"}, "code"=>"Wilson", "start_date"=>"2021-04-14T00:00:00.000Z", "end_date"=>"2021-04-18T00:00:00.000Z", "adults"=>2, "children"=>2, "infants"=>0, "guests"=>4, "status"=>"pending", "nights"=>4, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "guest_id"=>17, "created_at"=>"2023-02-23T09:28:07.881Z", "updated_at"=>"2023-02-23T09:28:07.881Z"}
Completed 500 Internal Server Error in 106ms (ActiveRecord: 4.0ms | Allocations: 33786)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:19:in `create'
Started POST "/reservations" for 172.19.0.1 at 2023-02-24 02:37:47 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `reservation'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m  [["code", "Wilson"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 17 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m  [["code", "Wilson"], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 17 LIMIT 1[0m  [["id", 17], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:70:in `update_reservation'
complete out={:guest=>{"id"=>17, "email"=>"mrcbstmnte@bnb.com", "first_name"=>"Marc", "last_name"=>"Bee", "phone_numbers"=>["639123456789"], "created_at"=>"2023-02-23T09:28:07.859Z", "updated_at"=>"2023-02-23T09:28:07.859Z"}, "code"=>"Wilson", "start_date"=>"2021-04-14T00:00:00.000Z", "end_date"=>"2021-04-18T00:00:00.000Z", "adults"=>2, "children"=>2, "infants"=>0, "guests"=>4, "status"=>"pending", "nights"=>4, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "guest_id"=>17, "created_at"=>"2023-02-23T09:28:07.881Z", "updated_at"=>"2023-02-23T09:28:07.881Z"}
Completed 500 Internal Server Error in 99ms (ActiveRecord: 4.6ms | Allocations: 36323)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:19:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (10.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_dev"[0m
  [1m[35m (8.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_db_test"[0m
  [1m[35m (65.8ms)[0m  [1m[35mCREATE DATABASE "airking_dev" ENCODING = 'utf8'[0m
  [1m[35m (60.3ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.8ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text[] DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE TABLE "reservations" ("code" character varying NOT NULL, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.5ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-24 02:40:17.125639', '2023-02-24 02:40:17.125639') RETURNING "key"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '343e32890587c79ea7cdead8ad12ebdcf8f2677d', '2023-02-24 02:40:17.135291', '2023-02-24 02:40:17.135291') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.3ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (5.2ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text[] DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.6ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "reservations" ("code" character varying NOT NULL, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.0ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.1ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.8ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.7ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.3ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-24 02:40:17.191598', '2023-02-24 02:40:17.191598') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.1ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-02-24 02:40:17.197558' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '343e32890587c79ea7cdead8ad12ebdcf8f2677d', '2023-02-24 02:40:17.203824', '2023-02-24 02:40:17.203824') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.0ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.24.0.1 at 2023-02-24 02:40:55 +0000
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('mrcbstmnte@bnb.com', 'Marc', 'Bee', '{639123456789}', '2023-02-24 02:40:55.893127', '2023-02-24 02:40:55.893127') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `reservation'
  [1m[36mReservation Create (0.6ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('Wilson', 1, '2021-04-14 00:00:00', '2021-04-18 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '4200.00', '500', '4700.00', '2023-02-24 02:40:55.917593', '2023-02-24 02:40:55.917593')[0m
  ↳ lib/payloads/base.rb:51:in `create_reservation'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
fail err=ActiveRecord::UnknownPrimaryKey msg=Unknown primary key for table reservations in model Reservation.
Completed 500 Internal Server Error in 338ms (ActiveRecord: 7.8ms | Allocations: 64607)


  
ActiveRecord::UnknownPrimaryKey (Unknown primary key for table reservations in model Reservation.):
  
lib/payloads/base.rb:70:in `update_reservation'
lib/payloads/base.rb:64:in `save_reservation'
lib/payloads/base.rb:17:in `block in process'
lib/payloads/base.rb:12:in `process'
app/services/reservation_services/create.rb:23:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (13.5ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_dev"[0m
  [1m[35m (9.3ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_db_test"[0m
  [1m[35m (46.2ms)[0m  [1m[35mCREATE DATABASE "airking_dev" ENCODING = 'utf8'[0m
  [1m[35m (45.8ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text[] DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE TABLE "reservations" ("code" character varying NOT NULL, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.7ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.9ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.7ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-24 02:41:49.944672', '2023-02-24 02:41:49.944672') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '343e32890587c79ea7cdead8ad12ebdcf8f2677d', '2023-02-24 02:41:49.954086', '2023-02-24 02:41:49.954086') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (3.9ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text[] DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (1.9ms)[0m  [1m[35mCREATE TABLE "reservations" ("code" character varying NOT NULL, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.4ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.8ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-24 02:41:50.007556', '2023-02-24 02:41:50.007556') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-02-24 02:41:50.013431' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '343e32890587c79ea7cdead8ad12ebdcf8f2677d', '2023-02-24 02:41:50.020045', '2023-02-24 02:41:50.020045') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (16.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_dev"[0m
  [1m[35m (11.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "airking_db_test"[0m
  [1m[35m (54.3ms)[0m  [1m[35mCREATE DATABASE "airking_dev" ENCODING = 'utf8'[0m
  [1m[35m (44.9ms)[0m  [1m[35mCREATE DATABASE "airking_db_test" ENCODING = 'utf8'[0m
  [1m[35mSQL (0.2ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (4.8ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text[] DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (3.2ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying NOT NULL, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (1.0ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-24 02:42:21.645508', '2023-02-24 02:42:21.645508') RETURNING "key"[0m
  [1m[35m (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '6706fa8648a954a05b6c337a8ffc4208fd32f68d', '2023-02-24 02:42:21.656785', '2023-02-24 02:42:21.656785') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35mSQL (0.3ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "guests" CASCADE[0m
  [1m[35m (4.7ms)[0m  [1m[35mCREATE TABLE "guests" ("id" bigserial primary key, "email" character varying, "first_name" character varying NOT NULL, "last_name" character varying NOT NULL, "phone_numbers" text[] DEFAULT '{}', "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.3ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_guests_on_email" ON "guests"  ("email")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "reservations" CASCADE[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE TABLE "reservations" ("id" bigserial primary key, "code" character varying NOT NULL, "guest_id" integer NOT NULL, "start_date" timestamp, "end_date" timestamp, "nights" integer NOT NULL, "guests" integer NOT NULL, "adults" integer NOT NULL, "children" integer DEFAULT 0 NOT NULL, "infants" integer DEFAULT 0 NOT NULL, "status" character varying NOT NULL, "currency" character varying NOT NULL, "payout_price" character varying NOT NULL, "security_price" character varying NOT NULL, "total_price" character varying NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.2ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_reservations_on_code" ON "reservations"  ("code")[0m
  [1m[35m (0.9ms)[0m  [1m[35mALTER TABLE "reservations" ADD CONSTRAINT "fk_rails_a00daaa2d3"
FOREIGN KEY ("guest_id")
  REFERENCES "guests" ("id")
[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230223015218)[0m
  [1m[35m (1.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230223014841);

[0m
  [1m[35m (2.5ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('environment', 'development', '2023-02-24 02:42:21.713255', '2023-02-24 02:42:21.713255') RETURNING "key"[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Update (0.2ms)[0m  [1m[33mUPDATE "ar_internal_metadata" SET "value" = 'test', "updated_at" = '2023-02-24 02:42:21.719321' WHERE "ar_internal_metadata"."key" = 'environment'[0m
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'schema_sha1' LIMIT 1[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.2ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ('schema_sha1', '6706fa8648a954a05b6c337a8ffc4208fd32f68d', '2023-02-24 02:42:21.726569', '2023-02-24 02:42:21.726569') RETURNING "key"[0m
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:42:51 +0000
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('mrcbstmnte@bnb.com', 'Marc', 'Bee', '{639123456789}', '2023-02-24 02:42:52.444192', '2023-02-24 02:42:52.444192') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `reservation'
  [1m[36mReservation Create (0.6ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('Wilson', 1, '2021-04-14 00:00:00', '2021-04-18 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '4200.00', '500', '4700.00', '2023-02-24 02:42:52.469543', '2023-02-24 02:42:52.469543') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:51:in `create_reservation'
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:43:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out={:guest=>{"id"=>1, "email"=>"mrcbstmnte@bnb.com", "first_name"=>"Marc", "last_name"=>"Bee", "phone_numbers"=>["639123456789"], "created_at"=>"2023-02-24T02:42:52.444Z", "updated_at"=>"2023-02-24T02:42:52.444Z"}, "id"=>1, "start_date"=>"2021-04-14T00:00:00.000Z", "end_date"=>"2021-04-18T00:00:00.000Z", "adults"=>2, "children"=>2, "infants"=>0, "guests"=>4, "status"=>"pending", "nights"=>4, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "guest_id"=>1, "code"=>"Wilson", "created_at"=>"2023-02-24T02:42:52.469Z", "updated_at"=>"2023-02-24T02:42:52.469Z"}
Completed 500 Internal Server Error in 381ms (ActiveRecord: 8.6ms | Allocations: 68367)


  
FastJsonapi::MandatoryField (id is a mandatory field in the jsonapi spec):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:19:in `create'
Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:43:42 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:76:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:76:in `guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:45:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:80:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:72:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:45:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:72:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:72:in `update_reservation'
complete out=#<OpenStruct guest={"id"=>1, "email"=>"mrcbstmnte@bnb.com", "first_name"=>"Marc", "last_name"=>"Bee", "phone_numbers"=>["639123456789"], "created_at"=>"2023-02-24T02:42:52.444Z", "updated_at"=>"2023-02-24T02:42:52.444Z"}, id=1, start_date="2021-04-14T00:00:00.000Z", end_date="2021-04-18T00:00:00.000Z", adults=2, children=2, infants=0, guests=4, status="pending", nights=4, currency="AUD", payout_price="4200.00", security_price="500", total_price="4700.00", guest_id=1, code="Wilson", created_at="2023-02-24T02:42:52.469Z", updated_at="2023-02-24T02:42:52.469Z">
Completed 200 OK in 104ms (Views: 0.5ms | ActiveRecord: 6.1ms | Allocations: 37385)


Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:48:19 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:78:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:47:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:82:in `reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:47:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:74:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 117ms (Views: 0.6ms | ActiveRecord: 6.5ms | Allocations: 37464)


Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:48:34 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:78:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:47:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:82:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:47:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:74:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 107ms (Views: 0.6ms | ActiveRecord: 5.3ms | Allocations: 37174)


Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:48:35 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:78:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:78:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:47:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:82:in `reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:47:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:74:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:74:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 49ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 22840)


Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:48:49 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 99ms (Views: 0.4ms | ActiveRecord: 5.6ms | Allocations: 37207)


Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:50:04 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.7ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 105ms (Views: 0.4ms | ActiveRecord: 6.5ms | Allocations: 36954)


Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:50:05 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 39ms (Views: 0.3ms | ActiveRecord: 2.9ms | Allocations: 22752)


Started POST "/reservations" for 172.25.0.1 at 2023-02-24 02:50:06 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 41ms (Views: 0.6ms | ActiveRecord: 3.0ms | Allocations: 22746)


  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.26.0.1 at 2023-02-24 02:51:15 +0000
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 359ms (Views: 0.5ms | ActiveRecord: 6.0ms | Allocations: 67016)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 02:53:17 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 111ms (Views: 0.7ms | ActiveRecord: 6.7ms | Allocations: 37091)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 02:56:18 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 109ms (Views: 0.2ms | ActiveRecord: 5.9ms | Allocations: 37065)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 02:56:34 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 105ms (Views: 0.8ms | ActiveRecord: 7.0ms | Allocations: 36953)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 02:57:21 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 106ms (Views: 0.2ms | ActiveRecord: 5.6ms | Allocations: 36960)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 02:57:30 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 99ms (Views: 0.3ms | ActiveRecord: 5.7ms | Allocations: 37108)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 02:57:39 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[36mCACHE Reservation Exists? (0.0ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mCACHE Reservation Load (0.0ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ lib/payloads/base.rb:66:in `update_reservation'
complete out=#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">
Completed 200 OK in 93ms (Views: 0.2ms | ActiveRecord: 5.2ms | Allocations: 36948)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:05:23 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.8ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
fail err=Hashie::Extensions::DeepFetch::UndefinedPathError msg=Could not fetch path (reservation > guest_email) at guest_email
Completed 500 Internal Server Error in 64ms (ActiveRecord: 2.2ms | Allocations: 56343)


  
Hashie::Extensions::DeepFetch::UndefinedPathError (Could not fetch path (reservation > guest_email) at guest_email):
  
lib/core_extensions/hash/deep_fetch.rb:13:in `fetch_nested'
lib/payloads/abnb.rb:11:in `guest_email'
lib/payloads/base.rb:70:in `guest'
lib/payloads/base.rb:13:in `block in process'
lib/payloads/base.rb:12:in `process'
app/services/reservation_services/create.rb:21:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:07:01 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'Wilson' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'Wilson' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" IS NULL LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (5.5ms)[0m  [1m[32mINSERT INTO "guests" ("phone_numbers", "created_at", "updated_at") VALUES (NULL, '2023-02-24 03:07:01.313569', '2023-02-24 03:07:01.313569') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
fail err=ActiveRecord::NotNullViolation msg=PG::NotNullViolation: ERROR:  null value in column "first_name" of relation "guests" violates not-null constraint
DETAIL:  Failing row contains (2, null, null, null, null, 2023-02-24 03:07:01.313569, 2023-02-24 03:07:01.313569).

Completed 500 Internal Server Error in 139ms (ActiveRecord: 14.7ms | Allocations: 68052)


  
ActiveRecord::NotNullViolation (PG::NotNullViolation: ERROR:  null value in column "first_name" of relation "guests" violates not-null constraint
DETAIL:  Failing row contains (2, null, null, null, null, 2023-02-24 03:07:01.313569, 2023-02-24 03:07:01.313569).
):
  
lib/payloads/base.rb:43:in `create_guest'
lib/payloads/base.rb:56:in `save_guest'
lib/payloads/base.rb:13:in `block in process'
lib/payloads/base.rb:12:in `process'
app/services/reservation_services/create.rb:21:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:07:38 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaab0a0a9b18 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 83ms (Views: 0.2ms | ActiveRecord: 1.4ms | Allocations: 48031)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:08:26 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff88023f90 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"first_name.first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 69ms (Views: 0.1ms | ActiveRecord: 1.4ms | Allocations: 47953)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:09:20 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff88339450 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"first_name.first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 85ms (Views: 0.1ms | ActiveRecord: 1.3ms | Allocations: 47967)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:12:33 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "guest"=>{"first_name"=>"", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"pending", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff84d553c0 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest.first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 72ms (Views: 0.3ms | ActiveRecord: 2.0ms | Allocations: 47961)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:12:44 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff84a75768 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>".status must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 14ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 46139)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:14:01 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NoMethodError msg=undefined method `gather_error_detail' for Utils::ErrorResponses::InvalidPayloadAttribute:Class
Completed 500 Internal Server Error in 78ms (ActiveRecord: 1.6ms | Allocations: 48843)


  
NoMethodError (undefined method `gather_error_detail' for Utils::ErrorResponses::InvalidPayloadAttribute:Class):
  
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/reservation_services/create.rb:24:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:8:in `create'
Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:15:33 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff84a34ba0 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>".status must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 71ms (Views: 0.3ms | ActiveRecord: 1.7ms | Allocations: 47919)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:16:38 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffffa0015b30 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"value.first", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 68ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 47917)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:16:48 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"Wilson", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "guest"=>{"first_name"=>"Marc", "last_name"=>"Bee", "phone"=>"639123456789", "email"=>"mrcbstmnte@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff88194c08 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"status must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 67ms (Views: 0.2ms | ActiveRecord: 1.3ms | Allocations: 47907)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:17:12 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff84c37330 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"guest_details.localized_description must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.guest_last_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 23ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 48189)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:20:01 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff880cc848 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.key.localized_description must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.guest_last_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 76ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 49966)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:20:11 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"", "guest_last_name"=>"", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff84c87010 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.guest_details.localized_description must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.guest_first_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.guest_last_name must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 94ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 49967)


Started GET "/reservations" for 172.26.0.1 at 2023-02-24 03:40:27 +0000
Processing by ReservationsController#index as */*
  [1m[36mReservation Load (0.7ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">]>
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations"[0m
  ↳ lib/utils/response.rb:25:in `to_h'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ app/serializers/reservations_serializer.rb:24:in `block in <class:ReservationsSerializer>'
Completed 200 OK in 78ms (Views: 0.3ms | ActiveRecord: 6.9ms | Allocations: 17360)


Started GET "/reservations" for 172.26.0.1 at 2023-02-24 03:40:36 +0000
Processing by ReservationsController#index as */*
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">]>
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations"[0m
  ↳ lib/utils/response.rb:25:in `to_h'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ app/serializers/reservations_serializer.rb:24:in `block in <class:ReservationsSerializer>'
Completed 200 OK in 15ms (Views: 0.2ms | ActiveRecord: 1.1ms | Allocations: 2522)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:40:53 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Rob", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff84dd8158 @errors=[{:attribute=>"", :code=>:invalid_payload_attribute, :detail=>"reservation.guest_details.localized_description must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 66ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 48070)


Started POST "/reservations" for 172.26.0.1 at 2023-02-24 03:40:59 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4 guests", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Rob", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.8ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.6ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne1911_woodbridge@bnb.com', 'Wayne', 'Rob', '{639123456789,639123456789}', '2023-02-24 03:40:59.171346', '2023-02-24 03:40:59.171346') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' AND "reservations"."guest_id" != 3 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'HHH12345679' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (0.7ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('HHH12345679', 3, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-24 03:40:59.182394', '2023-02-24 03:40:59.182394') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 2, code: "HHH12345679", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">
Completed 200 OK in 46ms (Views: 0.2ms | ActiveRecord: 3.7ms | Allocations: 52707)


Started GET "/reservations" for 172.26.0.1 at 2023-02-24 03:41:01 +0000
Processing by ReservationsController#index as */*
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Reservation id: 2, code: "HHH12345679", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">]>
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations"[0m
  ↳ lib/utils/response.rb:25:in `to_h'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ app/serializers/reservations_serializer.rb:24:in `block in <class:ReservationsSerializer>'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 3 LIMIT 1[0m
  ↳ app/serializers/reservations_serializer.rb:24:in `block in <class:ReservationsSerializer>'
Completed 200 OK in 17ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 3700)


Started GET "/guests" for 172.26.0.1 at 2023-02-24 03:55:55 +0000
  
ActionController::RoutingError (uninitialized constant GuestsController
Did you mean?  GuestController):
  
actionpack (6.0.6.1) lib/action_dispatch/http/request.rb:92:in `rescue in controller_class_for'
actionpack (6.0.6.1) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (6.0.6.1) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (6.0.6.1) lib/action_dispatch/routing/route_set.rb:44:in `controller'
actionpack (6.0.6.1) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.6.1) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack (2.2.6.2) lib/rack/etag.rb:27:in `call'
rack (2.2.6.2) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.6.2) lib/rack/head.rb:12:in `call'
activerecord (6.0.6.1) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.6.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.6.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.6.1) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.6.2) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.6.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.6.2) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.6.1) lib/rails/engine.rb:527:in `call'
puma (4.3.12) lib/puma/configuration.rb:228:in `call'
puma (4.3.12) lib/puma/server.rb:727:in `handle_request'
puma (4.3.12) lib/puma/server.rb:476:in `process_client'
puma (4.3.12) lib/puma/server.rb:332:in `block in run'
puma (4.3.12) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/guests" for 172.26.0.1 at 2023-02-24 03:56:17 +0000
Processing by GuestsController#index as */*
  [1m[36mGuest Load (0.8ms)[0m  [1m[34mSELECT "guests".* FROM "guests" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Guest id: 1, email: "mrcbstmnte@bnb.com", first_name: "Marc", last_name: "Bee", phone_numbers: ["639123456789"], created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Guest id: 3, email: "wayne1911_woodbridge@bnb.com", first_name: "Wayne", last_name: "Rob", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">]>
Completed 500 Internal Server Error in 85ms (ActiveRecord: 4.1ms | Allocations: 6318)


  
Zeitwerk::NameError (expected file /airking_api/app/serializers/guest_serializer.rb to define constant GuestSerializer, but didn't):
  
app/controllers/guests_controller.rb:10:in `index'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.8ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/guests/reservations" for 172.27.0.1 at 2023-02-24 06:41:03 +0000
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (uninitialized constant GuestController
Did you mean?  GuestsController):
  
actionpack (6.0.6.1) lib/action_dispatch/http/request.rb:92:in `rescue in controller_class_for'
actionpack (6.0.6.1) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (6.0.6.1) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (6.0.6.1) lib/action_dispatch/routing/route_set.rb:44:in `controller'
actionpack (6.0.6.1) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.6.1) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.6.1) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack (2.2.6.2) lib/rack/etag.rb:27:in `call'
rack (2.2.6.2) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.6.2) lib/rack/head.rb:12:in `call'
activerecord (6.0.6.1) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.6.1) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.6.1) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.6.1) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.6.1) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.6.1) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.6.2) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.6.1) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.6.2) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.6.1) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.6.1) lib/rails/engine.rb:527:in `call'
puma (4.3.12) lib/puma/configuration.rb:228:in `call'
puma (4.3.12) lib/puma/server.rb:727:in `handle_request'
puma (4.3.12) lib/puma/server.rb:476:in `process_client'
puma (4.3.12) lib/puma/server.rb:332:in `block in run'
puma (4.3.12) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/guests/reservations" for 172.27.0.1 at 2023-02-24 06:41:18 +0000
Processing by GuestsController#reservations as */*
fail err=NoMethodError msg=undefined method `[]' for nil:NilClass
Completed 500 Internal Server Error in 24ms (ActiveRecord: 0.0ms | Allocations: 948)


  
NoMethodError (undefined method `[]' for nil:NilClass):
  
app/services/guest_services/reservations.rb:9:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.27.0.1 at 2023-02-24 06:41:51 +0000
Processing by GuestsController#reservations as */*
fail err=NoMethodError msg=undefined method `InvalidAttribute' for Utils::ErrorResponses:Module
Completed 500 Internal Server Error in 15ms (ActiveRecord: 0.0ms | Allocations: 1417)


  
NoMethodError (undefined method `InvalidAttribute' for Utils::ErrorResponses:Module):
  
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/guests/reservations" for 172.28.0.1 at 2023-02-24 06:43:41 +0000
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by GuestsController#reservations as */*
fail err=NoMethodError msg=undefined method `InvalidAttribute' for Utils::ErrorResponses:Module
Completed 500 Internal Server Error in 14ms (ActiveRecord: 0.0ms | Allocations: 1489)


  
NoMethodError (undefined method `InvalidAttribute' for Utils::ErrorResponses:Module):
  
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.28.0.1 at 2023-02-24 06:44:05 +0000
Processing by GuestsController#reservations as */*
fail err=NoMethodError msg=undefined method `InvalidAttribute' for Utils::ErrorResponses:Module
Completed 500 Internal Server Error in 12ms (ActiveRecord: 0.0ms | Allocations: 1407)


  
NoMethodError (undefined method `InvalidAttribute' for Utils::ErrorResponses:Module):
  
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.28.0.1 at 2023-02-24 06:44:06 +0000
Processing by GuestsController#reservations as */*
fail err=NoMethodError msg=undefined method `InvalidAttribute' for Utils::ErrorResponses:Module
Completed 500 Internal Server Error in 4ms (ActiveRecord: 0.0ms | Allocations: 915)


  
NoMethodError (undefined method `InvalidAttribute' for Utils::ErrorResponses:Module):
  
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:44:20 +0000
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by GuestsController#reservations as */*
fail err=NoMethodError msg=undefined method `InvalidAttribute' for Utils::ErrorResponses:Module
Completed 500 Internal Server Error in 14ms (ActiveRecord: 0.0ms | Allocations: 1481)


  
NoMethodError (undefined method `InvalidAttribute' for Utils::ErrorResponses:Module):
  
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:14 +0000
Processing by GuestsController#reservations as */*
fail err=ArgumentError msg=unknown keyword: :errors
Completed 500 Internal Server Error in 43ms (ActiveRecord: 0.0ms | Allocations: 858)


  
ArgumentError (unknown keyword: :errors):
  
lib/utils/error_responses/base.rb:9:in `create'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:23 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 39ms (ActiveRecord: 0.0ms | Allocations: 922)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:48 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 30ms (ActiveRecord: 0.0ms | Allocations: 902)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:49 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 124)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:49 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 124)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:50 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 124)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:51 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 126)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:56 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 30ms (ActiveRecord: 0.0ms | Allocations: 916)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:45:57 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.0ms | Allocations: 124)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:46:33 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 45ms (ActiveRecord: 0.0ms | Allocations: 1022)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:43:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:47:43 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 38ms (ActiveRecord: 0.0ms | Allocations: 992)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:43:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:48:29 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 35ms (ActiveRecord: 0.0ms | Allocations: 977)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:44:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:48:45 +0000
Processing by GuestsController#reservations as */*
fail err=NoMethodError msg=undefined method `+' for {:email=>["email should be filled"]}:Hash
Completed 500 Internal Server Error in 34ms (ActiveRecord: 0.0ms | Allocations: 2059)


  
NoMethodError (undefined method `+' for {:email=>["email should be filled"]}:Hash):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:49:16 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=wrong element type Hash at 0 (expected array)
Completed 500 Internal Server Error in 27ms (ActiveRecord: 0.0ms | Allocations: 810)


  
TypeError (wrong element type Hash at 0 (expected array)):
  
app/services/guest_services/reservations.rb:18:in `to_h'
app/services/guest_services/reservations.rb:18:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:49:39 +0000
Processing by GuestsController#reservations as */*
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 44ms (ActiveRecord: 0.0ms | Allocations: 1034)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:46:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:45:in `each'
lib/utils/error_responses/base.rb:45:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 06:49:54 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"HHH12345679", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Rob", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff801dfb20 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_details.localized_description must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 352ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 78482)


Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:50:23 +0000
Processing by GuestsController#reservations as */*
complete out=#<Utils::ErrorResponses::Error:0x0000aaaaeb45e048 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"email should be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 43ms (Views: 0.5ms | ActiveRecord: 0.0ms | Allocations: 1293)


Started GET "/guests/reservations" for 172.30.0.1 at 2023-02-24 06:50:35 +0000
Processing by GuestsController#reservations as */*
complete out=#<Utils::ErrorResponses::Error:0x0000aaaae9801378 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"email should be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 42ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 1330)


Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:50:47 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.8ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
  ↳ app/services/application_service.rb:44:in `message'
fail err=NoMethodError msg=undefined method `reservations' for #<ActiveRecord::Relation []>
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
Completed 500 Internal Server Error in 38ms (ActiveRecord: 3.1ms | Allocations: 5411)


  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
  
NoMethodError (undefined method `reservations' for #<ActiveRecord::Relation []>):
  
app/services/guest_services/reservations.rb:10:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:51:05 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' ORDER BY "guests"."id" ASC LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:10:in `perform'
fail err=NoMethodError msg=undefined method `reservations' for nil:NilClass
Completed 500 Internal Server Error in 34ms (ActiveRecord: 2.9ms | Allocations: 2899)


  
NoMethodError (undefined method `reservations' for nil:NilClass):
  
app/services/guest_services/reservations.rb:10:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:51:07 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' ORDER BY "guests"."id" ASC LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:10:in `perform'
fail err=NoMethodError msg=undefined method `reservations' for nil:NilClass
Completed 500 Internal Server Error in 7ms (ActiveRecord: 0.6ms | Allocations: 1304)


  
NoMethodError (undefined method `reservations' for nil:NilClass):
  
app/services/guest_services/reservations.rb:10:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:51:19 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
  ↳ app/services/guest_services/reservations.rb:10:in `p'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
  ↳ app/services/application_service.rb:44:in `message'
fail err=NoMethodError msg=undefined method `reservations' for #<ActiveRecord::Relation []>
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
Completed 500 Internal Server Error in 40ms (ActiveRecord: 1.0ms | Allocations: 5424)


  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
  
NoMethodError (undefined method `reservations' for #<ActiveRecord::Relation []>):
  
app/services/guest_services/reservations.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:51:50 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:10:in `perform'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
  ↳ app/services/application_service.rb:44:in `message'
fail err=NoMethodError msg=undefined method `reservations' for #<ActiveRecord::Relation []>
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
Completed 500 Internal Server Error in 47ms (ActiveRecord: 1.5ms | Allocations: 5487)


  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
  
NoMethodError (undefined method `reservations' for #<ActiveRecord::Relation []>):
  
app/services/guest_services/reservations.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:52:01 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:10:in `perform'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m  [["email", "mrcbstmnte@ggmail.com"], ["LIMIT", 1]]
  ↳ app/services/guest_services/reservations.rb:12:in `perform'
fail err=NoMethodError msg=undefined method `reservations' for nil:NilClass
Completed 500 Internal Server Error in 40ms (ActiveRecord: 1.5ms | Allocations: 3167)


  
NoMethodError (undefined method `reservations' for nil:NilClass):
  
app/services/guest_services/reservations.rb:12:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:56:00 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 11[0m
  ↳ app/services/guest_services/reservations.rb:22:in `p'
complete out=[]
Completed 200 OK in 56ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 2905)


Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:57:34 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:20:in `perform'
complete out=[]
Completed 200 OK in 53ms (Views: 0.2ms | ActiveRecord: 2.4ms | Allocations: 2879)


Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 06:57:46 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:20:in `perform'
fail err=NoMethodError msg=undefined method `reservations' for nil:NilClass
Completed 500 Internal Server Error in 37ms (ActiveRecord: 1.2ms | Allocations: 2698)


  
NoMethodError (undefined method `reservations' for nil:NilClass):
  
app/services/guest_services/reservations.rb:21:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 07:03:51 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:30:in `guest'
complete out=[]
Completed 200 OK in 57ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 2992)


Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 07:04:58 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:27:in `guest'
fail err=GuestServices::Reservations::GuestNotFoundError msg=GuestServices::Reservations::GuestNotFoundError
Completed 500 Internal Server Error in 33ms (ActiveRecord: 2.9ms | Allocations: 2327)


  
GuestServices::Reservations::GuestNotFoundError (GuestServices::Reservations::GuestNotFoundError):
  
app/services/guest_services/reservations.rb:13:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 07:06:38 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
fail err=NameError msg=uninitialized constant Utils::ErrorResponses::RecordNotFound
Did you mean?  Utils::ErrorResponses::ResourceNotFound
Completed 500 Internal Server Error in 42ms (ActiveRecord: 2.3ms | Allocations: 4196)


  
NameError (uninitialized constant Utils::ErrorResponses::RecordNotFound
Did you mean?  Utils::ErrorResponses::ResourceNotFound):
  
app/services/guest_services/reservations.rb:23:in `rescue in perform'
app/services/guest_services/reservations.rb:11:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 07:06:53 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
fail err=NameError msg=uninitialized constant ErrorResponses::Base
Did you mean?  Base64
Completed 500 Internal Server Error in 51ms (ActiveRecord: 1.2ms | Allocations: 4204)


  
NameError (uninitialized constant ErrorResponses::Base
Did you mean?  Base64):
  
lib/utils/error_responses/resource_not_found.rb:5:in `<module:ErrorResponses>'
lib/utils/error_responses/resource_not_found.rb:3:in `<main>'
app/services/guest_services/reservations.rb:23:in `rescue in perform'
app/services/guest_services/reservations.rb:11:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/guests_controller.rb:15:in `reservations'
Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 07:07:19 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff741c65f0 @errors=[{:attribute=>"", :code=>:resource_not_found, :detail=>"Guest with mrcbstmnte@ggmail.com email was not found.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=404>
Completed 404 Not Found in 79ms (Views: 0.5ms | ActiveRecord: 1.5ms | Allocations: 3141)


Started GET "/guests/reservations?email=mrcbstmnte@ggmail.com" for 172.30.0.1 at 2023-02-24 07:07:38 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@ggmail.com"}
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@ggmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff78273030 @errors=[{:attribute=>"", :code=>:resource_not_found, :detail=>"Guest with email 'mrcbstmnte@ggmail.com' was not found.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=404>
Completed 404 Not Found in 58ms (Views: 0.1ms | ActiveRecord: 1.3ms | Allocations: 3155)


Started GET "/guests/reservations?email=mrcbstmnte@gmail.com" for 172.30.0.1 at 2023-02-24 07:07:57 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@gmail.com"}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@gmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff78252880 @errors=[{:attribute=>"", :code=>:resource_not_found, :detail=>"Guest with email 'mrcbstmnte@gmail.com' was not found.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=404>
Completed 404 Not Found in 6ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 706)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:08:31 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"JKAJ849123", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"mrcbstmnte@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Rob", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'JKAJ849123' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'JKAJ849123' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (1.0ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('JKAJ849123', 1, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-24 07:08:32.038507', '2023-02-24 07:08:32.038507') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 3, code: "JKAJ849123", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:08:32", updated_at: "2023-02-24 07:08:32">
Completed 200 OK in 95ms (Views: 0.4ms | ActiveRecord: 7.9ms | Allocations: 65991)


Started GET "/guests/reservations?email=mrcbstmnte@gmail.com" for 172.30.0.1 at 2023-02-24 07:08:38 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@gmail.com"}
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@gmail.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff742377f0 @errors=[{:attribute=>"", :code=>:resource_not_found, :detail=>"Guest with email 'mrcbstmnte@gmail.com' was not found.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=404>
Completed 404 Not Found in 6ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 706)


Started GET "/guests/reservations?email=mrcbstmnte@bnb.com" for 172.30.0.1 at 2023-02-24 07:08:42 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@bnb.com"}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 1 LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Reservation id: 3, code: "JKAJ849123", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:08:32", updated_at: "2023-02-24 07:08:32">]>
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 1[0m
  ↳ lib/utils/response.rb:25:in `to_h'
  [1m[36mGuest Load (0.6ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ app/serializers/reservation_serializer.rb:24:in `block in <class:ReservationSerializer>'
  [1m[36mCACHE Guest Load (0.0ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/serializers/reservation_serializer.rb:24:in `block in <class:ReservationSerializer>'
Completed 200 OK in 26ms (Views: 0.3ms | ActiveRecord: 1.6ms | Allocations: 4869)


Started GET "/guests/reservations?email=mrcbstmnte@bnb.com" for 172.30.0.1 at 2023-02-24 07:11:10 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@bnb.com"}
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 1 LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Reservation id: 3, code: "JKAJ849123", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:08:32", updated_at: "2023-02-24 07:08:32">]>
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 1[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 85ms (Views: 0.4ms | ActiveRecord: 7.1ms | Allocations: 17168)


Started GET "/guests/reservations?email=mrcbstmnte@bnb.com" for 172.30.0.1 at 2023-02-24 07:11:25 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"mrcbstmnte@bnb.com"}
  [1m[36mGuest Load (0.2ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 1 LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Reservation id: 3, code: "JKAJ849123", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:08:32", updated_at: "2023-02-24 07:08:32">]>
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 1[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 66ms (Views: 0.4ms | ActiveRecord: 4.7ms | Allocations: 17075)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:11:30 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"JKAJ849123", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"mrcbstmnte@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Rob", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'mrcbstmnte@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'JKAJ849123' AND "reservations"."guest_id" != 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'JKAJ849123' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 3 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 1 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 3, code: "JKAJ849123", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:08:32", updated_at: "2023-02-24 07:08:32">
Completed 200 OK in 80ms (Views: 0.2ms | ActiveRecord: 2.3ms | Allocations: 54268)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:29:05 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"JKAJ849123", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (1.1ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.9ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-24 07:29:05.308082', '2023-02-24 07:29:05.308082') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'JKAJ849123' AND "reservations"."guest_id" != 4 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[35m (0.9ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff740acc78 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 119ms (Views: 0.2ms | ActiveRecord: 3.6ms | Allocations: 51543)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:29:14 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"WKKKA444", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.7ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge@bnb.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-24 07:29:14.307966', '2023-02-24 07:29:14.307966') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'WKKKA444' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'WKKKA444' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (2.7ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('WKKKA444', 5, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-24 07:29:14.321317', '2023-02-24 07:29:14.321317') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 4, code: "WKKKA444", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">
Completed 200 OK in 48ms (Views: 0.2ms | ActiveRecord: 5.6ms | Allocations: 52270)


Started GET "/reservations" for 172.30.0.1 at 2023-02-24 07:30:01 +0000
Processing by ReservationsController#index as */*
  [1m[36mReservation Load (0.6ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Reservation id: 2, code: "HHH12345679", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">, #<Reservation id: 3, code: "JKAJ849123", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:08:32", updated_at: "2023-02-24 07:08:32">, #<Reservation id: 4, code: "WKKKA444", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">]>
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations"[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 31ms (Views: 0.5ms | ActiveRecord: 1.0ms | Allocations: 3945)


Started GET "/guests" for 172.30.0.1 at 2023-02-24 07:30:33 +0000
Processing by GuestsController#index as */*
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Guest id: 1, email: "mrcbstmnte@bnb.com", first_name: "Marc", last_name: "Bee", phone_numbers: ["639123456789"], created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Guest id: 3, email: "wayne1911_woodbridge@bnb.com", first_name: "Wayne", last_name: "Rob", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">, #<Guest id: 5, email: "wayne_woodbridge@bnb.com", first_name: "Wayne", last_name: "Woodbridge", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">]>
Completed 500 Internal Server Error in 70ms (ActiveRecord: 0.7ms | Allocations: 2047)


  
Zeitwerk::NameError (expected file /airking_api/app/serializers/guest_serializer.rb to define constant GuestSerializer, but didn't):
  
app/controllers/guests_controller.rb:10:in `index'
Started GET "/guests" for 172.30.0.1 at 2023-02-24 07:31:03 +0000
Processing by GuestsController#index as */*
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Guest id: 1, email: "mrcbstmnte@bnb.com", first_name: "Marc", last_name: "Bee", phone_numbers: ["639123456789"], created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Guest id: 3, email: "wayne1911_woodbridge@bnb.com", first_name: "Wayne", last_name: "Rob", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">, #<Guest id: 5, email: "wayne_woodbridge@bnb.com", first_name: "Wayne", last_name: "Woodbridge", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">]>
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests"[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 69ms (Views: 0.2ms | ActiveRecord: 7.7ms | Allocations: 7405)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:31:19 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"JKAJ849123", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@xxx.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (1.1ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@xxx.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.7ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge@xxx.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-24 07:31:19.124985', '2023-02-24 07:31:19.124985') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'JKAJ849123' AND "reservations"."guest_id" != 6 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff782557b0 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 101ms (Views: 0.1ms | ActiveRecord: 3.4ms | Allocations: 52283)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:31:24 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"GFBDDA", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@xxx.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.8ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@xxx.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.5ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge@xxx.com', 'Wayne', 'Woodbridge', '{639123456789,639123456789}', '2023-02-24 07:31:24.397801', '2023-02-24 07:31:24.397801') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'GFBDDA' AND "reservations"."guest_id" != 7 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'GFBDDA' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (0.4ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('GFBDDA', 7, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-24 07:31:24.415322', '2023-02-24 07:31:24.415322') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 5, code: "GFBDDA", guest_id: 7, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:31:24", updated_at: "2023-02-24 07:31:24">
Completed 200 OK in 62ms (Views: 0.2ms | ActiveRecord: 5.0ms | Allocations: 60312)


Started GET "/guests" for 172.30.0.1 at 2023-02-24 07:31:26 +0000
Processing by GuestsController#index as */*
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Guest id: 1, email: "mrcbstmnte@bnb.com", first_name: "Marc", last_name: "Bee", phone_numbers: ["639123456789"], created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Guest id: 3, email: "wayne1911_woodbridge@bnb.com", first_name: "Wayne", last_name: "Rob", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">, #<Guest id: 5, email: "wayne_woodbridge@bnb.com", first_name: "Wayne", last_name: "Woodbridge", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">, #<Guest id: 7, email: "wayne_woodbridge@xxx.com", first_name: "Wayne", last_name: "Woodbridge", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 07:31:24", updated_at: "2023-02-24 07:31:24">]>
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests"[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 9ms (Views: 0.2ms | ActiveRecord: 0.8ms | Allocations: 2186)


Started GET "/guests/reservations?email=wayne1911_woodbridge@bnb.com" for 172.30.0.1 at 2023-02-24 07:32:14 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"wayne1911_woodbridge@bnb.com"}
  [1m[36mGuest Load (2.1ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
  [1m[36mReservation Load (0.7ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 3 LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 2, code: "HHH12345679", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">]>
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 3[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 33ms (Views: 0.3ms | ActiveRecord: 3.2ms | Allocations: 3449)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:32:26 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"LGJKAWPIFMS", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (1.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'LGJKAWPIFMS' AND "reservations"."guest_id" != 3 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'LGJKAWPIFMS' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (0.8ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('LGJKAWPIFMS', 3, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-24 07:32:26.610991', '2023-02-24 07:32:26.610991') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 6, code: "LGJKAWPIFMS", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:32:26", updated_at: "2023-02-24 07:32:26">
Completed 200 OK in 46ms (Views: 0.2ms | ActiveRecord: 4.1ms | Allocations: 51245)


Started GET "/guests/reservations?email=wayne1911_woodbridge@bnb.com" for 172.30.0.1 at 2023-02-24 07:32:29 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"wayne1911_woodbridge@bnb.com"}
  [1m[36mGuest Load (1.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 3 LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 2, code: "HHH12345679", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">, #<Reservation id: 6, code: "LGJKAWPIFMS", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:32:26", updated_at: "2023-02-24 07:32:26">]>
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 3[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 2.0ms | Allocations: 2731)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:37:09 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"LGJKAWPIFMS", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne1911_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"", "total_paid_amount_accurate"=>""}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaaaea5e1e98 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.status_type must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.total_paid_amount_accurate must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 53ms (Views: 0.6ms | ActiveRecord: 0.0ms | Allocations: 48704)


Started GET "/reservations" for 172.30.0.1 at 2023-02-24 07:37:33 +0000
Processing by ReservationsController#index as */*
  [1m[36mReservation Load (0.7ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 1, code: "Wilson", guest_id: 1, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Reservation id: 2, code: "HHH12345679", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">, #<Reservation id: 3, code: "JKAJ849123", guest_id: 1, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:08:32", updated_at: "2023-02-24 07:08:32">, #<Reservation id: 4, code: "WKKKA444", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">, #<Reservation id: 5, code: "GFBDDA", guest_id: 7, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:31:24", updated_at: "2023-02-24 07:31:24">, #<Reservation id: 6, code: "LGJKAWPIFMS", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:32:26", updated_at: "2023-02-24 07:32:26">]>
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations"[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 32ms (Views: 0.7ms | ActiveRecord: 1.1ms | Allocations: 3700)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:37:55 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"LGJKAWPIFMS", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (2.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'LGJKAWPIFMS' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000aaaaeb47b620 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 34ms (Views: 0.2ms | ActiveRecord: 3.3ms | Allocations: 49143)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:38:19 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (0.8ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('YYY12345678', 5, '2021-04-14 00:00:00', '2021-04-18 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '4200.00', '500', '4700.00', '2023-02-24 07:38:19.795835', '2023-02-24 07:38:19.795835') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 7, code: "YYY12345678", guest_id: 5, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 07:38:19", updated_at: "2023-02-24 07:38:19">
Completed 200 OK in 41ms (Views: 0.2ms | ActiveRecord: 6.4ms | Allocations: 19206)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:38:34 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaaaea95c8e8 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 16ms (Views: 0.4ms | ActiveRecord: 0.0ms | Allocations: 47590)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:39:02 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff801b4a88 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation_code must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 18ms (Views: 0.1ms | ActiveRecord: 0.0ms | Allocations: 46141)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:39:09 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaaaea5e2b18 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 24ms (Views: 1.3ms | ActiveRecord: 0.0ms | Allocations: 47593)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:39:42 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff781bfa80 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 82ms (Views: 0.3ms | ActiveRecord: 2.5ms | Allocations: 49462)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:40:25 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaaae96fc5e0 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 81ms (Views: 0.9ms | ActiveRecord: 1.5ms | Allocations: 49469)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:40:44 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8015cab8 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 68ms (Views: 0.2ms | ActiveRecord: 1.0ms | Allocations: 49437)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:41:12 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff74017830 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 97ms (Views: 0.7ms | ActiveRecord: 2.2ms | Allocations: 49431)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:43:59 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"LGJKAWPIFMS", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'LGJKAWPIFMS' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000aaaae99ee758 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 137ms (Views: 0.3ms | ActiveRecord: 6.2ms | Allocations: 56135)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:44:25 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"LGJKAWPIFMS", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'LGJKAWPIFMS' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000aaaaeb3ec858 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 102ms (Views: 0.1ms | ActiveRecord: 3.7ms | Allocations: 56112)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:44:42 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff782829e0 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.code is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.expected_payout_amount is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_details is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_email is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_first_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_last_name is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.guest_phone_numbers is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.listing_security_price_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.host_currency is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.number_of_guests is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.status_type is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation.total_paid_amount_accurate is missing", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 31ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 48748)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:48:39 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NoMethodError msg=undefined method `flatten' for #<Utils::ErrorResponses::Error:0x0000ffff8013db18>
Completed 500 Internal Server Error in 86ms (ActiveRecord: 2.7ms | Allocations: 49085)


  
NoMethodError (undefined method `flatten' for #<Utils::ErrorResponses::Error:0x0000ffff8013db18>):
  
app/services/reservation_services/create.rb:29:in `block in perform'
app/services/reservation_services/create.rb:26:in `each'
app/services/reservation_services/create.rb:26:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:48:47 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NoMethodError msg=undefined method `count' for #<Utils::ErrorResponses::Error:0x0000aaaaeb679490>
Completed 500 Internal Server Error in 64ms (ActiveRecord: 1.4ms | Allocations: 49031)


  
NoMethodError (undefined method `count' for #<Utils::ErrorResponses::Error:0x0000aaaaeb679490>):
  
app/services/reservation_services/create.rb:26:in `each'
app/services/reservation_services/create.rb:26:in `min_by'
app/services/reservation_services/create.rb:26:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:49:23 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NoMethodError msg=undefined method `errors' for #<Array:0x0000ffff8015c7c0>
Completed 500 Internal Server Error in 61ms (ActiveRecord: 1.6ms | Allocations: 50043)


  
NoMethodError (undefined method `errors' for #<Array:0x0000ffff8015c7c0>):
  
app/services/reservation_services/create.rb:26:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 07:49:37 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NoMethodError msg=undefined method `errors' for #<Array:0x0000aaaaeb0acb20>
Completed 500 Internal Server Error in 62ms (ActiveRecord: 1.2ms | Allocations: 50280)


  
NoMethodError (undefined method `errors' for #<Array:0x0000aaaaeb0acb20>):
  
app/services/reservation_services/create.rb:28:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:01:58 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NoMethodError msg=undefined method `count' for #<Utils::AttributeErrorParser:0x0000ffff7817d658>
Completed 500 Internal Server Error in 83ms (ActiveRecord: 0.0ms | Allocations: 48727)


  
NoMethodError (undefined method `count' for #<Utils::AttributeErrorParser:0x0000ffff7817d658>):
  
app/services/reservation_services/create.rb:28:in `each'
app/services/reservation_services/create.rb:28:in `min_by'
app/services/reservation_services/create.rb:28:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:02:22 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NoMethodError msg=undefined method `gather_error_detail' for #<Utils::AttributeErrorParser:0x0000ffff7406a210>
Did you mean?  gather_error_details
Completed 500 Internal Server Error in 75ms (ActiveRecord: 3.5ms | Allocations: 49126)


  
NoMethodError (undefined method `gather_error_detail' for #<Utils::AttributeErrorParser:0x0000ffff7406a210>
Did you mean?  gather_error_details):
  
lib/utils/attribute_error_parser.rb:33:in `block in gather_error_details'
lib/utils/attribute_error_parser.rb:26:in `each'
lib/utils/attribute_error_parser.rb:26:in `gather_error_details'
lib/utils/attribute_error_parser.rb:15:in `parse'
app/services/reservation_services/create.rb:38:in `parse_errors'
app/services/reservation_services/create.rb:20:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:02:34 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=ArgumentError msg=unknown keyword: :error
Completed 500 Internal Server Error in 52ms (ActiveRecord: 1.7ms | Allocations: 48124)


  
ArgumentError (unknown keyword: :error):
  
lib/utils/attribute_error_parser.rb:25:in `gather_error_details'
lib/utils/attribute_error_parser.rb:33:in `block in gather_error_details'
lib/utils/attribute_error_parser.rb:26:in `each'
lib/utils/attribute_error_parser.rb:26:in `gather_error_details'
lib/utils/attribute_error_parser.rb:15:in `parse'
app/services/reservation_services/create.rb:38:in `parse_errors'
app/services/reservation_services/create.rb:20:in `block in perform'
app/services/reservation_services/create.rb:16:in `each'
app/services/reservation_services/create.rb:16:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:03:57 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=[{:detail=>"reservation_code must be filled"}, {:detail=>"start_date must be filled"}]
Completed 500 Internal Server Error in 88ms (ActiveRecord: 2.6ms | Allocations: 50273)


  
NoMethodError (undefined method `code' for {:detail=>"reservation_code must be filled"}:Hash):
  
lib/utils/response.rb:25:in `to_h'
app/controllers/reservations_controller.rb:27:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:04:43 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=TypeError msg=no implicit conversion of Hash into Integer
Completed 500 Internal Server Error in 70ms (ActiveRecord: 1.8ms | Allocations: 48650)


  
TypeError (no implicit conversion of Hash into Integer):
  
lib/utils/error_responses/base.rb:42:in `block in gather_error_detail'
lib/utils/error_responses/base.rb:41:in `each'
lib/utils/error_responses/base.rb:41:in `gather_error_detail'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/reservation_services/create.rb:28:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:05:51 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
fail err=NoMethodError msg=undefined method `detail' for {:detail=>"reservation_code must be filled"}:Hash
Completed 500 Internal Server Error in 73ms (ActiveRecord: 1.2ms | Allocations: 49745)


  
NoMethodError (undefined method `detail' for {:detail=>"reservation_code must be filled"}:Hash):
  
lib/utils/error_responses/base.rb:32:in `block in create_errors'
lib/utils/error_responses/base.rb:29:in `each'
lib/utils/error_responses/base.rb:29:in `create_errors'
app/services/reservation_services/create.rb:28:in `perform'
app/services/application_service.rb:40:in `run'
app/controllers/reservations_controller.rb:17:in `create'
Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:06:00 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff7822ed18 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation_code must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 82ms (Views: 0.4ms | ActiveRecord: 1.7ms | Allocations: 49058)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:06:15 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000aaaaea389d58 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation_code must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 70ms (Views: 0.1ms | ActiveRecord: 1.7ms | Allocations: 49009)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:07:22 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"", "start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
complete out=#<Utils::ErrorResponses::Error:0x0000ffff8016f578 @errors=[{:attribute=>"", :code=>:invalid_attribute, :detail=>"reservation_code must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}, {:attribute=>"", :code=>:invalid_attribute, :detail=>"start_date must be filled", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=409>
Completed 409 Conflict in 94ms (Views: 0.2ms | ActiveRecord: 2.6ms | Allocations: 49045)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:09:00 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Load (0.3ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 7 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `update_reservation'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 7, code: "YYY12345678", guest_id: 5, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 07:38:19", updated_at: "2023-02-24 07:38:19">
Completed 200 OK in 104ms (Views: 0.3ms | ActiveRecord: 7.4ms | Allocations: 34763)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:09:04 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge11@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge11@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Create (0.8ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge11@bnb.com', 'Wayne', 'Woodbridge', '{639123456789}', '2023-02-24 08:09:04.212563', '2023-02-24 08:09:04.212563') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' AND "reservations"."guest_id" != 8 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff781beb58 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 38ms (Views: 0.1ms | ActiveRecord: 2.4ms | Allocations: 18421)


Started GET "/guests" for 172.30.0.1 at 2023-02-24 08:09:24 +0000
Processing by GuestsController#index as */*
  [1m[36mGuest Load (0.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Guest id: 1, email: "mrcbstmnte@bnb.com", first_name: "Marc", last_name: "Bee", phone_numbers: ["639123456789"], created_at: "2023-02-24 02:42:52", updated_at: "2023-02-24 02:42:52">, #<Guest id: 3, email: "wayne1911_woodbridge@bnb.com", first_name: "Wayne", last_name: "Rob", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">, #<Guest id: 5, email: "wayne_woodbridge@bnb.com", first_name: "Wayne", last_name: "Woodbridge", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">, #<Guest id: 7, email: "wayne_woodbridge@xxx.com", first_name: "Wayne", last_name: "Woodbridge", phone_numbers: ["639123456789", "639123456789"], created_at: "2023-02-24 07:31:24", updated_at: "2023-02-24 07:31:24">]>
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests"[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 26ms (Views: 0.3ms | ActiveRecord: 1.3ms | Allocations: 2369)


Started GET "/guests/reservations?email=wayne1911_woodbridge@bnb.com" for 172.30.0.1 at 2023-02-24 08:09:38 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"wayne1911_woodbridge@bnb.com"}
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne1911_woodbridge@bnb.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 3 LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 2, code: "HHH12345679", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 03:40:59", updated_at: "2023-02-24 03:40:59">, #<Reservation id: 6, code: "LGJKAWPIFMS", guest_id: 3, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:32:26", updated_at: "2023-02-24 07:32:26">]>
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 3[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 28ms (Views: 0.3ms | ActiveRecord: 1.7ms | Allocations: 3825)


Started GET "/guests/reservations?email=wayne_woodbridge@bnb.com" for 172.30.0.1 at 2023-02-24 08:09:46 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"wayne_woodbridge@bnb.com"}
  [1m[36mGuest Load (0.9ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 5 LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 4, code: "WKKKA444", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">, #<Reservation id: 7, code: "YYY12345678", guest_id: 5, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 07:38:19", updated_at: "2023-02-24 07:38:19">]>
  [1m[36mReservation Load (0.6ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 5[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 14ms (Views: 0.2ms | ActiveRecord: 1.9ms | Allocations: 2728)


Started POST "/reservations" for 172.30.0.1 at 2023-02-24 08:10:06 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation"=>{"code"=>"LKGUWENM", "start_date"=>"2021-03-12", "end_date"=>"2021-03-16", "expected_payout_amount"=>"3800.00", "guest_details"=>{"localized_description"=>"4", "number_of_adults"=>2, "number_of_children"=>2, "number_of_infants"=>0}, "guest_email"=>"wayne_woodbridge@bnb.com", "guest_first_name"=>"Wayne", "guest_last_name"=>"Woodbridge", "guest_phone_numbers"=>["639123456789", "639123456789"], "listing_security_price_accurate"=>"500.00", "host_currency"=>"AUD", "nights"=>4, "number_of_guests"=>4, "status_type"=>"pending", "total_paid_amount_accurate"=>"4300.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `guest'
  [1m[36mReservation Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'LKGUWENM' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'LKGUWENM' LIMIT 1[0m
  ↳ lib/payloads/base.rb:74:in `reservation'
  [1m[36mReservation Create (0.7ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('LKGUWENM', 5, '2021-03-12 00:00:00', '2021-03-16 00:00:00', 4, 4, 2, 2, 'pending', 'AUD', '3800.00', '500.00', '4300.00', '2023-02-24 08:10:06.488821', '2023-02-24 08:10:06.488821') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:47:in `create_reservation'
  [1m[35m (3.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 8, code: "LKGUWENM", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 08:10:06", updated_at: "2023-02-24 08:10:06">
Completed 200 OK in 52ms (Views: 0.3ms | ActiveRecord: 5.8ms | Allocations: 51345)


Started GET "/guests/reservations?email=wayne_woodbridge@bnb.com" for 172.30.0.1 at 2023-02-24 08:10:09 +0000
Processing by GuestsController#reservations as */*
  Parameters: {"email"=>"wayne_woodbridge@bnb.com"}
  [1m[36mGuest Load (0.7ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ app/services/guest_services/reservations.rb:31:in `guest'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 5 LIMIT 11[0m
  ↳ app/services/application_service.rb:41:in `block in run'
complete out=#<ActiveRecord::Relation [#<Reservation id: 4, code: "WKKKA444", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 07:29:14", updated_at: "2023-02-24 07:29:14">, #<Reservation id: 7, code: "YYY12345678", guest_id: 5, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 07:38:19", updated_at: "2023-02-24 07:38:19">, #<Reservation id: 8, code: "LKGUWENM", guest_id: 5, start_date: "2021-03-12 00:00:00", end_date: "2021-03-16 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "pending", currency: "AUD", payout_price: "3800.00", security_price: "500.00", total_price: "4300.00", created_at: "2023-02-24 08:10:06", updated_at: "2023-02-24 08:10:06">]>
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."guest_id" = 5[0m
  ↳ lib/utils/response.rb:25:in `to_h'
Completed 200 OK in 14ms (Views: 0.3ms | ActiveRecord: 1.5ms | Allocations: 3110)


  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.5ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(8764310158225489770)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Load (1.4ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = 'environment' LIMIT 1[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(8764310158225489770)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started POST "/reservations" for 172.18.0.1 at 2023-02-25 08:41:11 +0000
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:66:in `guest'
  [1m[36mGuest Load (2.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `guest'
  [1m[36mReservation Exists? (1.7ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.2ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `reservation'
  [1m[36mReservation Load (0.4ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."id" = 7 LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `update_reservation'
  [1m[36mGuest Load (0.3ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."id" = 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:62:in `update_reservation'
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 7, code: "YYY12345678", guest_id: 5, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-24 07:38:19", updated_at: "2023-02-24 07:38:19">
Completed 200 OK in 282ms (Views: 0.3ms | ActiveRecord: 9.3ms | Allocations: 65982)


Started POST "/reservations" for 172.18.0.1 at 2023-02-25 08:41:18 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"YYY12345678", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge2@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:66:in `guest'
  [1m[36mGuest Load (0.4ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge2@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `guest'
  [1m[36mGuest Create (2.1ms)[0m  [1m[32mINSERT INTO "guests" ("email", "first_name", "last_name", "phone_numbers", "created_at", "updated_at") VALUES ('wayne_woodbridge2@bnb.com', 'Wayne', 'Woodbridge', '{639123456789}', '2023-02-25 08:41:18.744762', '2023-02-25 08:41:18.744762') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:52:in `save_guest'
  [1m[36mReservation Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'YYY12345678' AND "reservations"."guest_id" != 9 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Utils::ErrorResponses::Error:0x0000ffff6c0e2a10 @errors=[{:attribute=>"", :code=>:invalid_association, :detail=>"The reservation is already associated to another guest.", :resource_id=>"", :source=>{:pointer=>"", :attribute=>""}}], @http_code=422>
Completed 422 Unprocessable Entity in 31ms (Views: 0.1ms | ActiveRecord: 3.3ms | Allocations: 18514)


Started POST "/reservations" for 172.18.0.1 at 2023-02-25 08:41:25 +0000
Processing by ReservationsController#create as */*
  Parameters: {"reservation_code"=>"LKLKLK", "start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "guest"=>{"first_name"=>"Wayne", "last_name"=>"Woodbridge", "phone"=>"639123456789", "email"=>"wayne_woodbridge@bnb.com"}, "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00", "reservation"=>{"start_date"=>"2021-04-14", "end_date"=>"2021-04-18", "nights"=>4, "guests"=>4, "adults"=>2, "children"=>2, "infants"=>0, "status"=>"accepted", "currency"=>"AUD", "payout_price"=>"4200.00", "security_price"=>"500", "total_price"=>"4700.00"}}
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ lib/payloads/base.rb:66:in `guest'
  [1m[36mGuest Load (0.5ms)[0m  [1m[34mSELECT "guests".* FROM "guests" WHERE "guests"."email" = 'wayne_woodbridge@bnb.com' LIMIT 1[0m
  ↳ lib/payloads/base.rb:66:in `guest'
  [1m[36mReservation Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "reservations" WHERE "reservations"."code" = 'LKLKLK' AND "reservations"."guest_id" != 5 LIMIT 1[0m
  ↳ lib/payloads/base.rb:39:in `associated_to_user?'
  [1m[36mReservation Load (0.5ms)[0m  [1m[34mSELECT "reservations".* FROM "reservations" WHERE "reservations"."code" = 'LKLKLK' LIMIT 1[0m
  ↳ lib/payloads/base.rb:70:in `reservation'
  [1m[36mReservation Create (1.1ms)[0m  [1m[32mINSERT INTO "reservations" ("code", "guest_id", "start_date", "end_date", "nights", "guests", "adults", "children", "status", "currency", "payout_price", "security_price", "total_price", "created_at", "updated_at") VALUES ('LKLKLK', 5, '2021-04-14 00:00:00', '2021-04-18 00:00:00', 4, 4, 2, 2, 'accepted', 'AUD', '4200.00', '500', '4700.00', '2023-02-25 08:41:25.984323', '2023-02-25 08:41:25.984323') RETURNING "id"[0m
  ↳ lib/payloads/base.rb:43:in `create_reservation'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ lib/payloads/base.rb:12:in `process'
complete out=#<Reservation id: 9, code: "LKLKLK", guest_id: 5, start_date: "2021-04-14 00:00:00", end_date: "2021-04-18 00:00:00", nights: 4, guests: 4, adults: 2, children: 2, infants: 0, status: "accepted", currency: "AUD", payout_price: "4200.00", security_price: "500", total_price: "4700.00", created_at: "2023-02-25 08:41:25", updated_at: "2023-02-25 08:41:25">
Completed 200 OK in 25ms (Views: 0.2ms | ActiveRecord: 3.8ms | Allocations: 19239)


